Ext.define("LSP.view.Appmoduletree",{extend:"Ext.tree.Panel",alias:"widget.appmoduletree",requires:["Ext.data.TreeStore"],rootVisible:false,useArrows:true,frame:false,autoScroll:true,height:"100%",store:"NavigationTree",listeners:{itemclick:function(a,b,f,d,g,c){console.log("AppmoduleTree: itemclick()");if(b.raw.application_type=="grid"){Ext.History.add("!p="+b.raw.xtype)}}},initComponent:function(){this.callParent(arguments)}});Ext.define("LSP.store.NavigationTree",{extend:"Ext.data.TreeStore",root:{expanded:true,children:[{xtype:"",cls:"folder",text:"OPS",leaf:false,expanded:false,children:[{xtype:"",cls:"folder",text:"Exemplars",leaf:false,children:[{xtype:"temp",leaf:true,text:"X-Chem-Bio Navigator",cls:"file",application_type:"grid"},{xtype:"temp",leaf:true,text:"X-Target Dossier",cls:"file",application_type:"grid"},{xtype:"temp",leaf:true,text:"X-Polypharmacology Browser",cls:"file",application_type:"grid"}]},{xtype:"",leaf:false,text:"Pharmacology",cls:"folder",children:[{xtype:"PharmEnzymeForm",home:"Compounds active against enzyme family",leaf:true,text:"Pharmacology by Enzyme family",cls:"file",application_type:"grid"},{xtype:"PharmByCmpdNameForm",home:"Pharmacology by Compound name",leaf:true,text:"Pharmacology by Compound",cls:"file",application_type:"grid"},{xtype:"PharmByTargetNameForm",home:"Pharmacology by Target Name",leaf:true,text:"Pharmacology by Target",cls:"file",application_type:"grid"}]},{xtype:"",home:"",leaf:false,text:"Target",cls:"folder",children:[{xtype:"temp",home:"",leaf:true,text:"X-Target by sequence",cls:"file",application_type:"grid"},{xtype:"TargetByNameForm",home:"Target by name",leaf:true,text:"Target by name",cls:"file",application_type:"grid"}]},{xtype:"",home:"",leaf:false,text:"Compound",cls:"folder",children:[{xtype:"SimSearchForm",home:"Compound Structure Search",leaf:true,text:"Compound by structure",cls:"file",application_type:"grid"},{xtype:"CmpdByNameForm",home:"Compound by name",leaf:true,text:"Compound by name",cls:"file",application_type:"grid"}]}]},{xtype:"",home:"",leaf:false,text:"Searching",cls:"folder",children:[{xtype:"queryform",home:"SPARQL form",leaf:true,text:"SPARQL",cls:"file",url:"rdf.json"}]}]}});Ext.define("LDA.model.TargetModel",{extend:"Ext.data.Model",fields:["cw_target_uri","chembl_target_uri","drugbank_target_uri","label","label_src","keywords","keywords_src","description","description_src","target_type","target_type_src","organism","organism_src","synonyms","synonyms_src","cellular_location","cellular_location_src","molecular_weight","molecular_weight_src","number_of_residues","number_of_residues_src","pdb_id_page","pdb_id_page_src","specific_function","specific_function_src","theoretical_pi","theoretical_pi_src"]});Ext.define("LDA.model.CompoundModel",{extend:"Ext.data.Model",fields:["cw_uri","cs_uri","chembl_uri","drugbank_uri","inchi","inchi_src","inchi_key","inchi_key_src","smiles","smiles_src","alogp","alogp_src","full_mwt","full_mwt_src","hba","hba_src","hbd","hbd_src","molform","molform_src","mw_freebase","mw_freebase_src","psa","psa_src","rtb","rtb_src","biotransformation","biotransformation_src","description","description_src","proteinBinding","proteinBinding_src","toxicity","toxicity_src","prefLabel","prefLabel_src"]});Ext.define("LSP.view.target_by_name.TargetPanel",{extend:"Ext.panel.Panel",alias:"widget.TargetPanel",title:"Target Data",anchor:"100% 100%",autoScroll:true,bodyPadding:"10px",layout:"anchor",initComponent:function(){this.items=[{xtype:"panel",border:0,layout:"anchor",autoScroll:true,itemId:"dp",bodyPadding:"20px",cls:"target-data-panel",hidden:true,items:[{xtype:"panel",border:0,anchor:"100%",itemId:"topPanel",layout:"column",autoScroll:true,items:[{xtype:"image",itemId:"target_image",width:150,height:150,src:"./assets/target_placeholder.png"},{xtype:"panel",bodyPadding:30,columnWidth:1,border:0,autoScroll:true,itemId:"textDataPanel",layout:"anchor",items:[{xtype:"displayfield",anchor:"100%",itemId:"label",fieldCls:"target-title"},{xtype:"button",text:"Pharmacology Data",itemId:"pharmTargetButton",cls:"target-pharm-button"},{xtype:"displayfield",anchor:"100%",itemId:"target_type",fieldLabel:"Target Type",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"organism",fieldLabel:"Organism",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"description",fieldLabel:"Description",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"synonyms",fieldLabel:"Synonyms",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"specific_function",fieldLabel:"Specific Function",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"cellular_function",fieldLabel:"Cellular Function",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"keywords",fieldLabel:"Keywords",cls:"target-field-label"},{xtype:"displayfield",anchor:"100%",itemId:"pdb_id_page",fieldLabel:"PDB Entry",cls:"target-field-label"},{xtype:"panel",border:0,anchor:"100%",itemId:"numericDataPanel",layout:"column",bodyPadding:30,items:[{xtype:"displayfield",itemId:"molecular_weight",columnWidth:0.33,fieldLabel:"Molecular Weight",cls:"target-field-bottom",fieldCls:"target-field-bottom-field",labelAlign:"top"},{xtype:"displayfield",itemId:"number_of_residues",columnWidth:0.33,fieldLabel:"Number of Residues",cls:"target-field-bottom",fieldCls:"target-field-bottom-field",labelAlign:"top"},{xtype:"displayfield",itemId:"theoretical_pi",columnWidth:0.33,fieldLabel:"Theoretical Pi",cls:"target-field-bottom",fieldCls:"target-field-bottom-field",labelAlign:"top"}]}]}]}]},{xtype:"displayfield",border:0,padding:"20px",itemId:"msg",region:"center",hidden:true,fieldCls:"target-message",value:"message here"}];this.callParent(arguments)},resetAllFields:function(){var b=this.query("displayfield");Ext.each(b,function(c){c.hide()},this);var a=this.down("#target_image");a.setSrc("./assets/target_placeholder.png");this.doLayout()},showMessage:function(a){var c=this.down("#dp");var b=this.down("#msg");c.setVisible(false);b.setValue(a);b.setVisible(true)},showData:function(c,b,f){console.log("LSP.view.target_by_name.TargetPanel: showData()");if(f){if(b.length>0){var e=this.down("#dp");var d=this.down("#msg");d.setVisible(false);this.setValues(c.first());e.setVisible(true)}else{this.showMessage("No records found within OPS for this search")}}else{this.showMessage("Server did not respond")}this.up("TargetByNameForm").setLoading(false);var a=Ext.ComponentQuery.query("#TargetByNameSubmit_id")[0].enable()},clearDomBelow:function(a){if(a.hasChildNodes()){while(a.childNodes.length>0){a.removeChild(a.firstChild)}}},addKeywords:function(d){var f=d.split(",");var c=this.down("#keywords");var a=c.bodyEl;var e=a.dom;this.clearDomBelow(e);var b=Ext.DomHelper.createTemplate({tag:"div",cls:"keyword",html:"{kw}"});Ext.each(f,function(g){b.append(a,{kw:g.trim()})},this);c.show()},addOrganism:function(e){var d=this.down("#organism");var a=d.bodyEl;var c=a.dom;this.clearDomBelow(c);var b=Ext.DomHelper.createTemplate({tag:"div",cls:"organism",html:"{org}"});b.append(a,{org:e});d.show()},addSynonyms:function(a){var f=a.split("; ");var c=this.down("#synonyms");var b=c.bodyEl;var e=b.dom;this.clearDomBelow(e);var d=Ext.DomHelper.createTemplate({tag:"div",cls:"synonym",html:"{syn}"});Ext.each(f,function(g){d.append(b,{syn:g})},this);c.show()},addPDBImage:function(c){var e=new String(c);var b=this.down("#target_image");var a=e.substr(e.lastIndexOf("=")+1);var d=this.down("#pdbIdPage");d.setRawValue("<a target='_blank' href='"+c+"'>"+a+"</a>");d.show();b.setSrc("http://www.rcsb.org/pdb/images/"+a+"_asr_r_250.jpg");b.show()},setFieldValue:function(a,b){if(a=="synonyms"){if(b!=null){this.addSynonyms(b)}}else{if(a=="keywords"){if(b!=null){this.addKeywords(b)}}else{if(a=="organism"){if(b!=null){this.addOrganism(b)}}else{if(a=="pdb_id_page"){if(b!=""&&b!=null){this.addPDBImage(b)}}else{var c=this.down("#"+a);if(c!=null){c.setValue(b);c.show()}}}}}},setValues:function(a){this.resetAllFields();var d=a.data;var b=this.down("#pharmTargetButton");b.hide();b.setHandler(function(){Ext.History.add("!p=PharmByTargetNameForm&u="+a.store.proxy.extraParams.uri)});b.show();for(var c in d){if(d.hasOwnProperty(c)){this.setFieldValue(c,d[c])}}this.doLayout()}});Ext.define("LSP.view.cmpd_by_name.CmpdByNameSingleDisplayForm",{extend:"Ext.form.Panel",alias:"widget.CmpdByNameSingleDisplayForm",title:"Compound by Name search results",anchor:"100% 100%",autoScroll:true,bodyPadding:"10px",layout:"anchor",initComponent:function(){this.items=[{xtype:"panel",border:false,layout:"anchor",autoScroll:true,itemId:"displayPanel",bodyPadding:"20px",hidden:true,items:[{xtype:"panel",border:false,anchor:"100%",itemId:"topPanelDetails",layout:"column",items:[{xtype:"panel",itemId:"imageAndFigures",layout:"anchor",border:true,bodyPadding:"8px",items:[{xtype:"image",name:"image",itemId:"compound_form_imagepanel",width:150,height:150,src:"./assets/target_placeholder.png"},{xtype:"displayfield",name:"alogp",itemId:"alogp",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"20px 0 12px 0",fieldLabel:"ALogP",labelAlign:"top",columnWidth:0.1},{xtype:"displayfield",name:"hha",itemId:"hha",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"# H-Bond Receptors",columnWidth:0.13,labelAlign:"top"},{xtype:"displayfield",name:"hhd",itemId:"hhd",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"# H-Bond Donors",columnWidth:0.13,labelAlign:"top"},{xtype:"displayfield",name:"molweight",itemId:"molweight",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"Mol Weight",columnWidth:0.1,labelAlign:"top"},{xtype:"displayfield",name:"mw_freebase",itemId:"mw_freebase",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"MW Freebase",columnWidth:0.1,labelAlign:"top"},{xtype:"displayfield",name:"num_ro5_violations",itemId:"num_ro5_violations",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"# Rule of 5 Violations",columnWidth:0.14,labelAlign:"top"},{xtype:"displayfield",name:"psa",itemId:"psa",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"Polar Surface Area",columnWidth:0.12,labelAlign:"top"},{xtype:"displayfield",name:"rtb",itemId:"rtb",fieldCls:"x-cmpBottomfieldValue",baseCls:"x-cmpBottomBase",anchor:"100%",padding:"0 0 12px 0",fieldLabel:"# Rotatable Bonds",columnWidth:0.12,labelAlign:"top"}]},{xtype:"panel",bodyPadding:30,columnWidth:1,border:false,itemId:"dataPanel",layout:"anchor",items:[{xtype:"displayfield",name:"compound_name",itemId:"compound_name",anchor:"100%",fieldCls:"x-cmpTitle"},{xtype:"displayfield",itemId:"spacer4"},{xtype:"button",text:"Pharmacology Data",itemId:"pharmCompoundButton"},{xtype:"displayfield",value:"<br>",itemId:"spacer1"},{xtype:"displayfield",name:"description",itemId:"description",fieldCls:"x-cmpDescriptions",anchor:"90%",maxWidth:600},{xtype:"displayfield",itemId:"spacer2"},{xtype:"displayfield",name:"biotransformation",itemId:"biotransformation",fieldCls:"x-cmpDescriptions",anchor:"90%",maxWidth:600},{xtype:"displayfield",itemId:"spacer3",value:"<br>"},{xtype:"displayfield",name:"chemspider_id",itemId:"chemspider_id",cls:"x-cmpfield",labelWidth:120,labelAlign:"left",fieldLabel:"ChemSpider ID",anchor:"100%"},{xtype:"displayfield",name:"molformula",itemId:"molformula",cls:"x-cmpfield",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Molecular Formula"},{xtype:"displayfield",name:"smiles",itemId:"smiles",cls:"x-cmpfield",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"SMILES"},{xtype:"displayfield",name:"inchi",itemId:"inchi",cls:"x-cmpfield",labelWidth:120,maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Standard InChl"},{xtype:"displayfield",name:"inchiKey",itemId:"inchiKey",cls:"x-cmpfield",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Standard InChlKey"},{xtype:"displayfield",name:"affectedOrganism",itemId:"affectedOrganism",cls:"x-cmpfield",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Affected Organism"},{xtype:"displayfield",name:"indication",itemId:"indication",cls:"x-cmpfield",fieldCls:"x-cmpDescriptions",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Indication"},{xtype:"displayfield",name:"proteinBinding",itemId:"proteinBinding",cls:"x-cmpfield",fieldCls:"x-cmpDescriptions",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Protein Binding"},{xtype:"displayfield",name:"toxicity",itemId:"toxicity",cls:"x-cmpfield",fieldCls:"x-cmpDescriptions",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Toxicity"},{xtype:"displayfield",name:"meltingPoint",itemId:"meltingPoint",cls:"x-cmpfield",fieldCls:"x-cmpDescriptions",labelWidth:120,padding:"10px 0 0 0",maxWidth:570,anchor:"80%",labelAlign:"left",fieldLabel:"Melting Point"}]}]},{xtype:"panel",itemId:"bottomPanelDetails",bodyPadding:30,border:false,height:100,layout:"column",hidden:true,fieldDefaults:{labelAlign:"top",labelWidth:120,anchor:"100%"},items:[]},{xtype:"displayfield",border:0,padding:"20px",itemId:"msg",region:"center",hidden:true,fieldCls:"compound-message",value:"message here"}]}];this.callParent(arguments)},showData:function(l,c,k){if(k){if(c.length>0){var f=l.first();var m=this.query("#displayPanel")[0];m.show();var e=this.query("#dataPanel")[0];e.show();var j=this.query("#topPanelDetails")[0];j.show();var a=this.query("#bottomPanelDetails")[0];a.show();var g=this.query("#compound_form_imagepanel")[0];var d;if(f.data.cs_uri){d=f.data.cs_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];g.setSrc("http://www.chemspider.com/ImagesHandler.ashx?id="+d);g.show()}var b=this.down("#msg");b.hide();this.setValues(f)}else{this.showMessage("No records found within OPS for this search")}}else{this.showMessage("Server did not respond")}this.up("CmpdByNameForm").setLoading(false);var h=Ext.ComponentQuery.query("#CmpdByNameSubmit_id")[0].enable()},resetAllFields:function(){var a=this.query("displayfield");Ext.each(a,function(b){b.hide()},this);this.doLayout()},showSpacerFields:function(){var a=this.down("#spacer1");a.show();a=this.down("#spacer2");a.show();a=this.down("#spacer3");a.show();a=this.down("#spacer4");a.show()},setValues:function(k){this.resetAllFields();this.showSpacerFields();var c=k.data;var h=this.down("#pharmCompoundButton");h.hide();h.setHandler(function(){Ext.History.add("!p=PharmByCmpdNameForm&u="+k.store.proxy.extraParams.uri)});h.show();for(var a in c){if(c.hasOwnProperty(a)){var j=this.down("#"+a);if(j){switch(a){case"alogp":var e=new Number(c[a]);e=e.toFixed(1);j.setValue(e);j.show();break;case"molformula":var d=c[a];d=d.replace(/(\d+)?\s*/g,"<sub>$1</sub>");j.setValue(d);j.show();break;case"psa":var f=c[a];j.setValue(f);j.show();break;default:j.setValue(c[a]);j.show()}}else{}}}var g=this.query("#compound_form_imagepanel")[0];var b;if(k.data.cs_uri){b=k.data.cs_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];g.setSrc("http://www.chemspider.com/ImagesHandler.ashx?id="+b)}g.show();this.doLayout()},showMessage:function(b){var f=this.query("#displayPanel")[0];f.show();var g=this.query("#dataPanel")[0];g.hide();var e=this.query("#topPanelDetails")[0];e.hide();var a=this.query("#bottomPanelDetails")[0];a.hide();var d=this.query("#compound_form_imagepanel")[0];d.hide();var c=this.query("#msg")[0];c.setValue(b);c.setVisible(true)}});Ext.define("LSP.view.mol_editor_forms.KetcherForm",{extend:"Ext.window.Window",alias:"widget.KetcherForm",requires:["Ext.form.Panel"],title:"Draw structure",layout:"fit",modal:true,autoShow:true,height:570,width:810,initComponent:function(){this.items=[{xtype:"form",padding:"0 0 0 0",border:false,style:"background-color: #fff;",items:[{xtype:"box",width:800,height:520,id:"ketcher_box_id",autoEl:{tag:"iframe",src:"ketcher/ketcher.html"}}]}];this.buttons=[{text:"Use structure",action:"commit_structure"},{text:"Cancel",scope:this,handler:this.close}];this.callParent(arguments)}});Ext.define("LDA.helper.DynamicPagingToolbar",{extend:"Ext.toolbar.Paging",alias:"widget.dynamicpagingtoolbar",updatePager:function(){var f=this,d,b,c,a,e,g;e=f.store.getCount();g=e===0;if(!g){d=f.getPageData();b=d.currentPage;c=d.pageCount;a=Ext.String.format(f.afterPageText,isNaN(c)?1:c)}else{b=0;c=0;a=Ext.String.format(f.afterPageText,0)}Ext.suspendLayouts();f.child("#afterTextItem").setText(a);f.child("#inputItem").setDisabled(g).setValue(b);f.child("#first").setDisabled(b===1||g);f.child("#prev").setDisabled(b===1||g);f.child("#next").setDisabled(b===c||g);f.child("#last").setDisabled(b===c||g);f.child("#refresh").enable();f.updateInfo();Ext.resumeLayouts(true);if(f.rendered){f.fireEvent("change",f,d)}}});Ext.define("LSP.view.larkc_sim_search.SimSearchForm",{extend:"Ext.form.Panel",alias:"widget.SimSearchForm",requires:["LSP.view.mol_editor_forms.KetcherForm"],closable:true,layout:{type:"vbox",align:"stretch"},initComponent:function(){console.log("LSP.view.larkc_sim_search.SimSearchForm: initComponent()");this.items=[{xtype:"form",padding:"5 5 5 5",border:false,style:"background-color: #fff;",items:[{name:"molfile",xtype:"hidden",value:""},{xtype:"fieldcontainer",layout:"column",collapsible:false,defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"smiles",itemId:"smilesField",emptyText:"Enter SMILES here or use the molecular editor to draw structure - click button ->",fieldLabel:"Search for compounds similar to SMILES",labelWidth:230,width:650},{xtype:"button",action:"ketcher_editor",text:"Draw structure"}]},{xtype:"radiogroup",fieldLabel:"Search type",itemId:"searchTypeRadio",items:[{boxLabel:"Exact structure search",name:"search_type",inputValue:1,checked:true},{boxLabel:"Substructure search",name:"search_type",inputValue:2},{boxLabel:"Structural similarity search",name:"search_type",inputValue:3}]},{xtype:"button",action:"query",itemId:"sim_sss_start_search_button_id",text:"Start search..."}]},{xtype:"SimSearchScrollingGrid",itemId:"simSearchGrid",title:"Structure search results",gridBaseTitle:"Structure search results",flex:1}];this.callParent(arguments)},setFormData:function(b){console.log("SimSearchForm setFormData()");if(b.sm){var c=this.down("#smilesField");c.setValue(b.sm);var a=this.down("#searchTypeRadio");if(b.st){if(b.st=="exact"){a.setValue({search_type:1})}else{if(b.st=="sub"){a.setValue({search_type:2})}else{if(b.st=="sim"){a.setValue({search_type:3})}}}}else{a.setValue({search_type:1})}this.fireEvent("historyToken",b)}}});Ext.define("LDA.helper.JamesQueryStringEncoder",{extend:"Ext.Base",toQueryString:function(c){var b=[],h=[],d,a,e,g,f;for(d in c){if(c.hasOwnProperty(d)){b=b.concat(Ext.Object.toQueryObjects(d,c[d],false))}}for(a=0,e=b.length;a<e;a++){g=b[a];f=g.value;if(Ext.isEmpty(f)){continue}else{if(Ext.isDate(f)){f=Ext.Date.toString(f)}}h.push(encodeURIComponent(g.name)+"="+encodeURIComponent(String(f)))}return h.join("&")}});Ext.define("LDA.store.basestores.BaseStore",{extend:"Ext.data.Store",_format:"json",uri:"",BASE_URL:"",remoteSort:true,stringEncoder:Ext.create("LDA.helper.JamesQueryStringEncoder"),listeners:{beforeprefetch:{fn:function(){var a=this;a.updateProxyURL()}},beforeload:{fn:function(){var a=this;a.updateProxyURL()}}},sort:function(){var b=this,a=b.pageMap;if(b.buffered){if(b.remoteSort){a.clear();this.sortColumn(arguments);this.currentPage=1;this.guaranteeRange(0,49)}else{b.callParent(arguments)}}else{b.callParent(arguments)}},setURI:function(a){this.uri=a},updateProxyURL:function(){this.proxy.url=this.BASE_URL+this.stringEncoder.toQueryString({_format:this._format,uri:this.uri})}});Ext.define("LDA.model.SimModel",{extend:"Ext.data.Model",fields:["cw_uri","cs_uri","chembl_uri","drugbank_uri","inchi","inchi_src","inchi_key","inchi_key_src","smiles","smiles_src","alogp","alogp_src","full_mwt","full_mwt_src","hba","hba_src","hbd","hbd_src","molform","molform_src","mw_freebase","mw_freebase_src","psa","psa_src","rtb","rtb_src","biotransformation","biotransformation_src","description","description_src","proteinBinding","proteinBinding_src","toxicity","toxicity_src","prefLabel","prefLabel_src"]});Ext.define("LDA.store.SimSearchStore",{extend:"LDA.store.basestores.BaseStore",model:"LDA.model.SimModel",storeId:"SimSearchStore",BASE_URL:simSearchUrl,proxy:{type:"ajax",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.SimReader");this.callParent(b)}});Ext.define("LDA.store.TargetStore",{extend:"LDA.store.basestores.BaseStore",model:"LDA.model.TargetModel",storeId:"TargetStore",BASE_URL:"http://ops.few.vu.nl/target?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.TargetReader");this.callParent(b)}});Ext.define("LDA.store.CompoundStore",{extend:"LDA.store.basestores.BaseStore",model:"LDA.model.CompoundModel",storeId:"CompoundStore",BASE_URL:"http://ops.few.vu.nl/compound?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.CompoundReader");this.callParent(b)}});Ext.define("LSP.controller.CmpdByNameForm",{extend:"Ext.app.Controller",models:["LDA.model.CompoundModel"],stores:["LDA.store.CompoundStore"],views:["cmpd_by_name.CmpdByNameSingleDisplayForm"],refs:[{ref:"cmpdByNameSingleDisplayForm",selector:"CmpdByNameSingleDisplayForm"},{ref:"compoundImagePanel",selector:"CmpdByNameSingleDisplayForm #compound_form_imagepanel"},{ref:"formView",selector:"CmpdByNameForm"},{ref:"submitButton",selector:"#CmpdByNameSubmit_id"},{ref:"lookup",selector:"#compoundByNameLookup"}],init:function(){this.control({"CmpdByNameForm button[action=query_cmpd_by_name]":{click:this.submitQuery},"CmpdByNameForm conceptWikiLookup":{select:this.enableSubmit},CmpdByNameForm:{historyToken:this.handleHistoryToken}})},handleHistoryToken:function(b){console.log("CmpdByNameForm: handleHistoryToken()");var c=this;var e=c.getFormView().down("CmpdByNameSingleDisplayForm");if(b.u){var a=this.getLDAStoreCompoundStoreStore();if(b.u!=a.proxy.extraParams.uri){a.proxy.extraParams.uri=b.u;c.getFormView().setLoading(true);a.load(function(g,f,h){console.log("LSP.controller.CmpdByNameForm: store is loaded "+h);if(h){c.getSubmitButton().enable();e.setValues(g[0]);e.down("#displayPanel").setVisible(true);e.down("#msg").setVisible(false);c.getFormView().setLoading(false)}else{Ext.MessageBox.show({title:"Info",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO});c.getSubmitButton().enable();e.down("#displayPanel").setVisible(false);e.down("#msg").setVisible(true);c.getFormView().setLoading(false)}})}}else{if(b.s){var d=this.getLookup();d.setRawValue(b.s);d.doQuery(b.s)}}},enableSubmit:function(c){var b=this.getFormView();var a=this.getSubmitButton();a.enable()},submitQuery:function(b){b.disable();var c=this.getFormView();var a=c.getValues().compound_uri;Ext.History.add("!p=CmpdByNameForm&u="+a)}});Ext.define("LDA.helper.LDAConstants",{singleton:true,LDA_IN_DATASET:"inDataset",LDA_ABOUT:"_about",LDA_COMPOUND_PHARMACOLOGY_COUNT:"compoundPharmacologyTotalResults",LDA_TARGET_PHARMACOLOGY_COUNT:"targetPharmacologyTotalResults",LDA_ENZYME_FAMILY_COUNT:"enzymePharmacologyTotalResults",LDA_PERMITTED_ACTIVITY_TYPES:["IC50","Activity"],LDA_ON_ASSAY:"onAssay",LDA_EXACT_MATCH:"exactMatch",LDA_PRIMARY_TOPIC:"primaryTopic",LDA_RESULT:"result",LDA_ACTIVITY:"activity",LDA_FOR_MOLECULE:"forMolecule",LDA_ASSAY_TARGET:"target",LDA_ITEMS:"items",LDA_PAGINATED_NEXT:"next",LDA_PAGINATED_PREVIOUS:"prev",LDA_PAGINATED_PAGE_SIZE:"itemsPerPage",LDA_PAGINATED_START_INDEX:"startIndex",LDA_TARGET_OF_ASSAY:"targetOfAssay",LDA_ASSAY_OF_ACTIVITY:"assayOfActivity",LDA_SRC_CLS_MAPPINGS:{"http://www.conceptwiki.org":"conceptWikiValue","http://www.conceptwiki.org/":"conceptWikiValue","http://data.kasabi.com/dataset/chembl-rdf":"chemblValue","http://www4.wiwiss.fu-berlin.de/drugbank":"drugbankValue","http://linkedlifedata.com/resource/drugbank":"drugbankValue","http://www.chemspider.com":"chemspiderValue","http://www.chemspider.com/":"chemspiderValue","http://rdf.chemspider.com":"chemspiderValue","http://rdf.chemspider.com/":"chemspiderValue"},LDA_PROVENANCE_OFF:"Off",LDA_PROVENANCE_COLOUR:"Colour",LDA_PROVENANCE_ICON:"Icon",LDA_PROVENANCE_TEXT:"Text",LDAProvenanceMode:"Colour",LDADataItems:{compound_smiles:"smiles",activity_standard_value:"std_value",compound_inchikey:"inchikey",activity_activity_type:"std_type",activity_standard_units:"std_unit",target_pref_label:"target_name",activity_relation:"relation",compound_inchi:"inchi",compound_full_mwt:"molweight",cw_compound_uri:"compound_cw",compound_pref_label:"compound_name",target_organism:"assay_organism"}});Ext.define("LDA.helper.SimReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){var e=d.result["primaryTopic"];var b=e.exactMatch;var g;var f;var c;Ext.each(b,function(j,h,k){var l=j[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="chemspiderValue"){g=j}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="drugbankValue"){f=j}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="chemblValue"){c=j}}}});var a=Ext.create("LDA.model.SimModel",{cw_uri:e[LDA.helper.LDAConstants.LDA_ABOUT],cs_uri:g[LDA.helper.LDAConstants.LDA_ABOUT],chembl_uri:c[LDA.helper.LDAConstants.LDA_ABOUT],drugbank_uri:f[LDA.helper.LDAConstants.LDA_ABOUT],inchi:g.inchi,inchi_src:g[LDA.helper.LDAConstants.LDA_IN_DATASET],inchi_key:g.inchikey,inchi_key_src:g[LDA.helper.LDAConstants.LDA_IN_DATASET],smiles:g.smiles,smiles_src:g[LDA.helper.LDAConstants.LDA_IN_DATASET],alogp:c.alogp,alogp_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],full_mwt:c.full_mwt,full_mwt_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],hba:c.hba,hba_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],hbd:c.hbd,hbd_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],molform:c.molform,molform_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],mw_freebase:c.mw_freebase,mw_freebase_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],psa:c.psa,psa_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],rtb:c.rtb,rtb_src:c[LDA.helper.LDAConstants.LDA_IN_DATASET],biotransformation:f.biotransformation,biotransformation_src:f[LDA.helper.LDAConstants.LDA_IN_DATASET],description:f.description,description_src:f[LDA.helper.LDAConstants.LDA_IN_DATASET],proteinBinding:f.proteinBinding,proteinBinding_src:f[LDA.helper.LDAConstants.LDA_IN_DATASET],toxicity:f.toxicity,toxicity_src:f[LDA.helper.LDAConstants.LDA_IN_DATASET],prefLabel:e.prefLabel,prefLabel_src:e[LDA.helper.LDAConstants.LDA_IN_DATASET]});return new Ext.data.ResultSet({total:1,count:1,records:[a],success:true,message:"loaded"})}});Ext.define("LSP.model.DynamicGrid",{extend:"Ext.data.Model",fields:[]});Ext.define("LSP.view.Settings",{extend:"Ext.form.Panel",alias:"widget.settingsform",height:"100%",initComponent:function(){this.items=[{xtype:"form",padding:"5 5 0 5",border:false,style:"background-color: #fff;",items:[{xtype:"label",text:"To use a different endpoint than the default Amsterdam VU one insert URL of sparql endpoint below and click save"},{xtype:"textarea",name:"endpoint",heigth:50,fieldLabel:"URL",emptyText:"Insert full URL to the sparql endpoint used, eg: http://10.11.93.218:8183/sparql",labelWidth:30},{name:"utf8",xtype:"hidden",value:"&#x2713;"},{name:"authenticity_token",xtype:"hidden",value:$$("meta[name=csrf-token]")[0].readAttribute("content")},{xtype:"button",text:"Save",action:"save_endpoint"}]}];this.callParent(arguments)}});Ext.define("CW.model.ConceptWikiLookup",{extend:"Ext.data.Model",fields:[{name:"match",mapping:"match",type:"string"},{name:"uuid",mapping:"uuid",type:"string"},{name:"ops_uri",mapping:"ops_uri",type:"string"},{name:"pref_label",mapping:"pref_labels",type:"string"},{name:"alt_labels",mapping:"alt_labels",type:"string"},{name:"uuid",mapping:"uuid",type:"string"},{name:"concept_type_tags",mapping:"uuid_tags",type:"string"},{name:"pref_url",mapping:"pref_url",type:"string"},],getSomething:function(){if(this.something==null){this.parseSomething()}return this.something},parseSomething:function(){this.something=new Array();for(var b=0;b<this.data.something.length;b++){var a=this.data.tags[b];if(a.length==1){this.something.push(a)}}}});Ext.define("LDA.store.basestores.FilteringStore",{extend:"LDA.store.basestores.BaseStore",assay_organism:"",activity_type:"",activity_value:"",activity_condition:"",sort_column:"",sortColumn:function(b){console.log("LDA.store.basestores.FilteringStore: sortColumn()");var c="?"+LDADataItems[b[0].property];var a=b[0].direction;if(a=="DESC"){c="DESC("+c+")"}this.setSortColumn(c)},setSortColumn:function(a){this.sort_column=a},setAssayOrganism:function(a){this.assay_organism=a},setActivityType:function(a){this.activity_type=a},setActivityValue:function(a){this.activity_value=a},setActivityCondition:function(a){this.activity_condition=a},updateProxyURL:function(){this.proxy.url=this.BASE_URL+this.stringEncoder.toQueryString({assay_organism:this.assay_organism,activity_type:this.activity_type,_format:this._format,uri:this.uri});this.setAllConditions();console.log("Proxy: "+Ext.ClassManager.getName(this)+" URL updated to: "+this.proxy.url)},setAllConditions:function(){switch(this.activity_condition){case">":this.proxy.url=this.proxy.url+"&"+encodeURIComponent("minEx-activity_value")+"="+encodeURIComponent(String(this.activity_value));break;case"<":this.proxy.url=this.proxy.url+"&"+encodeURIComponent("maxEx-activity_value")+"="+encodeURIComponent(String(this.activity_value));break;case"=":this.proxy.url=this.proxy.url+"&"+encodeURIComponent("activity_value")+"="+encodeURIComponent(String(this.activity_value));break;case"<=":this.proxy.url=this.proxy.url+"&"+encodeURIComponent("max-activity_value")+"="+encodeURIComponent(String(this.activity_value));break;case">=":this.proxy.url=this.proxy.url+"&"+encodeURIComponent("min-activity_value")+"="+encodeURIComponent(String(this.activity_value));break}}});Ext.define("LDA.model.PharmacologyCountModel",{extend:"Ext.data.Model",fields:["count","uri"]});Ext.define("LDA.store.CompoundPharmacologyCountStore",{extend:"LDA.store.basestores.FilteringStore",model:"LDA.model.PharmacologyCountModel",storeId:"CompoundPharmacologyCountStore",countNode:"compoundPharmacologyTotalResults",BASE_URL:"http://ops.few.vu.nl/compound/pharmacology/count?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.CompoundPharmacologyCountReader");this.callParent(b)}});Ext.define("LSP.controller.Settings",{extend:"Ext.app.Controller",views:["Settings"],init:function(){this.control({"settingsform button[action=save_endpoint]":{click:this.saveEndpoint}})},saveEndpoint:function(b){var c=b.up("form");var a=c.getValues();c.submit({url:"/sparql_endpoint/settings.json",waitMsg:"Saving end point...",success:function(d,e){Ext.Msg.alert("Success","Endpoint stored")}})}});Ext.define("LDA.helper.CompoundPharmacologyCountReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){var b=d.result["primaryTopic"][LDA.helper.LDAConstants.LDA_COMPOUND_PHARMACOLOGY_COUNT];var c=d.result["primaryTopic"][LDA.helper.LDAConstants.LDA_ABOUT];var a=Ext.create("LDA.model.PharmacologyCountModel",{count:b,uri:c});console.log("LDA.model.PharmacologyCountModel: CompoundPharmacologyCount");return new Ext.data.ResultSet({total:1,count:1,records:[a],success:true,message:"loaded"})}});Ext.define("LDA.view.grids.CompoundPharmacologyCountGrid",{extend:"Ext.grid.Panel",alias:"widget.CompoundPharmacologyCountGrid",store:Ext.create("LDA.store.CompoundPharmacologyCountStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Compound URI",dataIndex:"uri",width:400},{header:"Pharmacology Count",dataIndex:"count",width:60}]}});Ext.define("LDA.helper.CompoundReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){var e=d.result["primaryTopic"];var b=e.exactMatch;var g;var f;var c;Ext.each(b,function(j,h,k){var l=j[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="chemspiderValue"){g=j}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="drugbankValue"){f=j}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[l]=="chemblValue"){c=j}}}});var a=Ext.create("LDA.model.CompoundModel",{cw_uri:e[LDA.helper.LDAConstants.LDA_ABOUT],cs_uri:g!=null?g[LDA.helper.LDAConstants.LDA_ABOUT]:null,chembl_uri:c!=null?c[LDA.helper.LDAConstants.LDA_ABOUT]:null,drugbank_uri:f!=null?f[LDA.helper.LDAConstants.LDA_ABOUT]:null,inchi:g!=null?g.inchi:null,inchi_src:g!=null?g[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,inchi_key:g!=null?g.inchikey:null,inchi_key_src:g!=null?g[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,smiles:g!=null?g.smiles:null,smiles_src:g!=null?g[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,alogp:c!=null?c.alogp:null,alogp_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,full_mwt:c!=null?c.full_mwt:null,full_mwt_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,hba:c!=null?c.hba:null,hba_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,hbd:c!=null?c.hbd:null,hbd_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,molform:c!=null?c.molform:null,molform_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,mw_freebase:c!=null?c.mw_freebase:null,mw_freebase_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,psa:c!=null?c.psa:null,psa_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,rtb:c!=null?c.rtb:null,rtb_src:c!=null?c[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,biotransformation:f!=null?f.biotransformation:null,biotransformation_src:f!=null?f[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,description:f!=null?f.description:null,description_src:f!=null?f[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,proteinBinding:f!=null?f.proteinBinding:null,proteinBinding_src:f!=null?f[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,toxicity:f!=null?f.toxicity:null,toxicity_src:f!=null?f[LDA.helper.LDAConstants.LDA_IN_DATASET]:null,prefLabel:e.prefLabel,prefLabel_src:e[LDA.helper.LDAConstants.LDA_IN_DATASET]});return new Ext.data.ResultSet({total:1,count:1,records:[a],success:true,message:"loaded"})}});Ext.define("LDA.view.grids.CompoundGrid",{extend:"Ext.grid.Panel",alias:"widget.CompoundGrid",store:Ext.create("LDA.store.CompoundStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Name",dataIndex:"prefLabel",width:100},{header:"CW URI",dataIndex:"cw_uri",width:400},{header:"CS URI",dataIndex:"cs_uri",width:400},{header:"Chembl URI",dataIndex:"chembl_uri",width:400},{header:"Drugbank URI",dataIndex:"drugbank_uri",width:400},{header:"Inchi",dataIndex:"inchi",width:100},{header:"Inchi key",dataIndex:"inchi_key",width:100},{header:"Smiles",dataIndex:"smiles",width:100},{header:"A log P",dataIndex:"alogp",width:100},{header:"Full Molecular Weight",dataIndex:"full_mwt",width:100},{header:"Hydrogen bond acceptors",dataIndex:"hba",width:100},{header:"Hydrogen bond donors",dataIndex:"hbd",width:100},{header:"Molecular forn",dataIndex:"molform",width:100},{header:"Freebase molecular weight",dataIndex:"mw_freebase",width:100},{header:"Polar surface area",dataIndex:"psa",width:100},{header:"Rotatable bonds",dataIndex:"rtb",width:100},{header:"Biotransformation",dataIndex:"biotransformation",width:400},{header:"Description",dataIndex:"description",width:400},{header:"Protein binding",dataIndex:"proteinBinding",width:400},{header:"Toxicity",dataIndex:"toxicity",width:400}]}});Ext.define("CW.config.Settings",{singleton:true,searchByTagUrl:"http://ops.conceptwiki.org/web-ws/concept/search/byTag",getConceptUrl:"http://ops.conceptwiki.org/web-ws/concept/get",base_ops_uri:"http://www.conceptwiki.org/concept/",lang_code:"en"});Ext.define("CW.store.ConceptWikiLookup",{extend:"Ext.data.Store",requires:["CW.model.ConceptWikiLookup","CW.config.Settings"],model:"CW.model.ConceptWikiLookup",constructor:function(){this.callParent(arguments);this.setProxy({type:"jsonp",timeout:5000,url:CW.config.Settings.searchByTagUrl,reader:Ext.create("CW.helper.ConceptWikiJSONReader")})}});Ext.define("CW.helper.ConceptWikiJSONReader",{extend:"Ext.data.reader.Json",readRecords:function(c){var a=[];var b=0;Ext.each(c,function(f){var e={};var g="";var h=[];Ext.each(f.labels,function(j){if(j.language.code==CW.config.Settings.lang_code){if(j.type=="PREFERRED"){g=j.text}if(j.type=="ALTERNATIVE"){h.push(j.text)}}});var d=[];pref_url="";Ext.each(f.urls,function(j){if(j.type=="PREFERRED"){pref_url=j.value;return false}});var e=Ext.create("CW.model.ConceptWikiLookup",{match:f.match.replace(/\<\/em\>/g,"</b>").replace(/\<em\>/g,"<b>"),uuid:f.uuid,ops_uri:CW.config.Settings.base_ops_uri+f.uuid,pref_label:g,alt_labels:h.join("; "),concept_type_tags:d.join("; "),pref_url:pref_url});a.push(e);b++});return new Ext.data.ResultSet({total:b,count:b,records:a,success:true,message:"loaded"})}});Ext.define("CW.view.ConceptWikiLookup",{extend:"Ext.form.ComboBox",alias:"widget.conceptWikiLookup",requires:["CW.model.ConceptWikiLookup","CW.helper.ConceptWikiJSONReader","CW.store.ConceptWikiLookup"],cwTagUuid:"pleaseConfigure[cwConceptTagUuid:]",store:Ext.create("CW.store.ConceptWikiLookup"),forceSelection:true,allowBlank:false,typeAhead:true,typeAheadDelay:250,queryDelay:250,queryCaching:false,queryParam:"q",queryMode:"remote",valueField:"ops_uri",displayField:"pref_label",name:"ops_uri",minChars:4,hideTrigger:true,forceSelection:true,allowBlank:false,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:700,fieldLabel:"Overwrite this in config",labelWidth:120,listConfig:{loadingText:"Searching...",emptyText:"No matching entities found.",getInnerTpl:function(){return'<p><span style="font-family: verdana; color: grey; "><small>Match: {match}</small></span><br/><b>{pref_label}</b> <a href="http://ops.conceptwiki.org/wiki/#/concept/{uuid}/view" target="_blank">(definition)</a></p>'}}});Ext.define("LDA.model.PharmacologyModel",{extend:"Ext.data.Model",fields:["cs_compound_uri","cw_compound_uri","chembl_compound_uri","drugbank_compound_uri","cw_target_uri","chembl_target_uri","drugbank_target_uri","chembl_assay_uri","chembl_activity_uri","target_preflabel","target_preflabel_src","target_title","target_title_src","target_organism","target_organism_src","compound_uuid","compound_uuid_src","compound_drug_type","compound_drug_type_src","compound_generic_name","compound_generic_name_src","compound_full_mwt","compound_full_mwt_src","compound_num_ro5_violations","compound_num_ro5_violations_src","compound_inchi","compound_inchi_src","compound_inchi_key","compound_inchi_key_src","compound_smiles","compound_smiles_src","compound_preflabel","compound_preflabel_src","assay_organism","assay_organism_src","activity_relation","activity_relation_src","activity_standard_units","activity_standard_units_src","activity_standard_value","activity_standard_value_src","activity_activity_type","activity_activity_type_src"]});Ext.define("LDA.store.CompoundPharmacologyStore",{extend:"LDA.store.basestores.FilteringStore",model:"LDA.model.PharmacologyModel",storeId:"CompoundPharmacologyStore",BASE_URL:"http://ops.few.vu.nl/compound/pharmacology?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.CompoundPharmacologyReader");this.callParent(b)}});Ext.define("CW.controller.ConceptWikiLookup",{extend:"Ext.app.Controller",models:["CW.model.ConceptWikiLookup"],views:["CW.view.ConceptWikiLookup"],init:function(){this.control({conceptWikiLookup:{afterrender:this.prepProxy}})},prepProxy:function(a){a.store.proxy.extraParams={uuid:a.cwTagUuid,limit:10}},setConcept:function(c,a){console.log("CW.controller.ConceptWikiLookup: setConcept()");var d=c.match(/http:\/\/www.conceptwiki.org\/concept\/([a-f0-9\-]+)/)[1];var b=Ext.create("Ext.data.Store",{model:"CW.model.ConceptWikiLookup",proxy:{type:"jsonp",url:CW.config.Settings.getConceptUrl,reader:Ext.create("CW.helper.ConceptWikiJSONGetReader")}});b.load({params:{uuid:d},callback:function(f,e,g){if(g){console.log("Success",f[0]);a.setValue(f[0])}else{}}},this)}});Ext.define("LDA.helper.CompoundPharmacologyReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(x){var w=this;var t=new Array();var q=x[LDA.helper.LDAConstants.LDA_RESULT][LDA.helper.LDAConstants.LDA_PRIMARY_TOPIC];var a=q[LDA.helper.LDAConstants.LDA_EXACT_MATCH];var k=null;var g=null;var j=null;Ext.each(a,function(z,y,A){var B=z[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[B]=="drugbankValue"){k=z}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[B]=="chemspiderValue"){g=z}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[B]=="chemblValue"){j=z}}}});var s=null;var o=null;var v=null;var u=null;var d=null;var m=null;var b=null;var e=null;var r=null;var f=null;var n=null;var h=null;if(k!=null){s=k[LDA.helper.LDAConstants.LDA_ABOUT];o=k[LDA.helper.LDAConstants.LDA_IN_DATASET];v=k.drugType;u=k.genericName}if(g!=null){d=g[LDA.helper.LDAConstants.LDA_ABOUT];m=g[LDA.helper.LDAConstants.LDA_IN_DATASET];b=g.inchi;e=g.inchikey;r=g.smiles}if(j!=null){f=j[LDA.helper.LDAConstants.LDA_ABOUT];n=j[LDA.helper.LDAConstants.LDA_IN_DATASET];h=j.full_mwt}var p=q[LDA.helper.LDAConstants.LDA_ABOUT];var c=q[LDA.helper.LDAConstants.LDA_IN_DATASET];var l=q.prefLabel;Ext.each(j[LDA.helper.LDAConstants.LDA_ACTIVITY],function(L,G,H){var J=L[LDA.helper.LDAConstants.LDA_ON_ASSAY];if(J!=undefined){var K=J[LDA.helper.LDAConstants.LDA_ASSAY_TARGET];var I=L[LDA.helper.LDAConstants.LDA_ABOUT];var N=J[LDA.helper.LDAConstants.LDA_ABOUT];var A=K[LDA.helper.LDAConstants.LDA_ABOUT];var D=K.title;var C=K.assay_organism;var y=J.assay_organism;var M=L.activity_type;var z=L.relation;var F=L.standardValue;var B=L.standardUnits;var E=new LDA.model.PharmacologyModel({cs_compound_uri:d,cw_compound_uri:p,chembl_compound_uri:f,drugbank_compound_uri:s,cw_target_uri:undefined,chembl_target_uri:A,drugbank_target_uri:undefined,chembl_assay_uri:N,chembl_activity_uri:I,target_preflabel:undefined,target_preflabel_src:undefined,target_title:D,target_title_src:n,target_organism:C,target_organism_src:n,compound_uuid:undefined,compound_uuid_src:undefined,compound_drug_type:v,compound_drug_type_src:o,compound_generic_name:u,compound_generic_name_src:o,compound_full_mwt:h,compound_full_mwt_src:n,compound_num_ro5_violations:undefined,compound_num_ro5_violations_src:undefined,compound_inchi:b,compound_inchi_src:m,compound_inchi_key:e,compound_inchi_key_src:m,compound_smiles:r,compound_smiles_src:m,compound_preflabel:l,compound_preflabel_src:c,assay_organism:y,assay_organism_src:n,activity_relation:z,activity_relation_src:n,activity_standard_units:B,activity_standard_units_src:n,activity_standard_value:F,activity_standard_value_src:n,activity_activity_type:M,activity_activity_type_src:n});t.push(E)}else{}},w);return new Ext.data.ResultSet({total:t.length,count:t.length,records:t,success:true,message:"loaded"})}});Ext.define("LDA.view.grids.CompoundPharmacologyGrid",{extend:"Ext.grid.Panel",alias:"widget.CompoundPharmacologyGrid",store:Ext.create("LDA.store.CompoundPharmacologyStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}},width:200},items:[{header:"ConceptWiki Compound URI",dataIndex:"cw_compound_uri"},{header:"Chemspider Compound URI",dataIndex:"cs_compound_uri"},{header:"ChEMBL Compound URI",dataIndex:"chembl_compound_uri"},{header:"DrugBank Compound URI",dataIndex:"drugbank_compound_uri"},{header:"ConceptWiki Target URI",dataIndex:"cw_target_uri"},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri"},{header:"DrugBank Target URI",dataIndex:"drugbank_target_uri"},{header:"ChEMBL Assay URI",dataIndex:"chembl_assay_uri"},{header:"ChEMBL Activity URI",dataIndex:"chembl_activity_uri"},{header:"Target Label",dataIndex:"target_title"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Compound Label",dataIndex:"compound_preflabel"},{header:"Compound UUID",dataIndex:"compound_uuid"},{header:"Compound Drug Type",dataIndex:"compound_drug_type"},{header:"Compound Generic Name",dataIndex:"compound_generic_name"},{header:"Compound Full Molecular Weight",dataIndex:"compound_full_mwt"},{header:"Compound Rule of 5 violations",dataIndex:"compound_num_ro5_violations"},{header:"Compound Inchi",dataIndex:"compound_inchi"},{header:"Compound Inchi Key",dataIndex:"compound_inchi_key"},{header:"Compound SMILES",dataIndex:"compound_smiles"},{header:"Assay Organism",dataIndex:"assay_organism"},{header:"Activity Type",dataIndex:"activity_activity_type"},{header:"Activity Relation",dataIndex:"activity_relation"},{header:"Activity Value",dataIndex:"activity_standard_value"},{header:"Activity Units",dataIndex:"activity_standard_units"}]}});Ext.define("LDA.store.basestores.PaginatedFilteringStore",{extend:"LDA.store.basestores.FilteringStore",pageSize:50,buffered:true,proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:"_pageSize",pageParam:"_page",callbackKey:"_callback",listeners:{exception:function(d,e,f,c,b,a){if(!b.isTimeout){Ext.Msg.show({title:"",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.Msg.OK,icon:Ext.MessageBox.INFO})}else{Ext.Msg.show({title:"",msg:"The OPS server is taking too long to respond. Response timed out.",buttons:Ext.Msg.OK,icon:Ext.MessageBox.INFO})}}}},updateProxyURL:function(){this.proxy.url=this.BASE_URL+this.stringEncoder.toQueryString({assay_organism:this.assay_organism,activity_type:this.activity_type,_orderBy:this.sort_column,_format:this._format,uri:this.uri});this.setAllConditions();console.log("Proxy: "+Ext.ClassManager.getName(this)+" URL updated to: "+this.proxy.url)},setTotalCount:function(a){this.totalCount=a}});Ext.define("LDA.model.PharmacologyPaginatedModel",{extend:"Ext.data.Model",fields:["page_uri","next_page","previous_page","page_size","start_index","compound_inchikey","compound_drug_type","compound_generic_name","target_title","target_concatenated_uris","compound_inchikey_src","compound_drug_type_src","compound_generic_name_src","target_title_src","target_concatenated_uris_src","chembl_activity_uri","chembl_compound_uri","compound_full_mwt","cw_compound_uri","compound_pref_label","cs_compound_uri","csid","compound_inchi","compound_smiles","chembl_assay_uri","chembl_target_uri","target_organism","target_pref_label","assay_organism","activity_relation","activity_standard_units","activity_standard_value","activity_activity_type","compound_full_mwt_src","compound_pref_label_src","compound_inchi_src","compound_smiles_src","target_organism_src","target_pref_label_src","assay_organism_src","activity_relation_src","activity_standard_units_src","activity_standard_value_src","activity_activity_type_src"]});Ext.define("LDA.store.CompoundPharmacologyPaginatedStore",{extend:"LDA.store.basestores.PaginatedFilteringStore",model:"LDA.model.PharmacologyPaginatedModel",storeId:"CompoundPharmacologyPaginatedStore",BASE_URL:"http://ops.few.vu.nl/compound/pharmacology/pages?",constructor:function(a,b){console.log("CompoundPharmacologyPaginatedStore: constructor()");this.proxy.reader=Ext.create("LDA.helper.CompoundPharmacologyPaginatedReader");this.callParent(b)},});Ext.define("LDA.helper.CompoundPharmacologyPaginatedReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){console.log("LDA.helper.CompoundPharmacologyPaginatedReader: readRecords");var h=this;var c=new Array();var l=d[LDA.helper.LDAConstants.LDA_RESULT];var k=l[LDA.helper.LDAConstants.LDA_ABOUT];var e=l[LDA.helper.LDAConstants.LDA_PAGINATED_NEXT];var a=l[LDA.helper.LDAConstants.LDA_PAGINATED_PREVIOUS];var g=l[LDA.helper.LDAConstants.LDA_PAGINATED_PAGE_SIZE];var j=l[LDA.helper.LDAConstants.LDA_PAGINATED_START_INDEX];var f=l[LDA.helper.LDAConstants.LDA_ITEMS];Ext.each(f,function(Q,x,I){var s=Q[LDA.helper.LDAConstants.LDA_ABOUT];var G=Q[LDA.helper.LDAConstants.LDA_IN_DATASET];var P=Q[LDA.helper.LDAConstants.LDA_FOR_MOLECULE];if(P!=null){var u=P[LDA.helper.LDAConstants.LDA_ABOUT];var N=P.full_mwt;var n=P[LDA.helper.LDAConstants.LDA_EXACT_MATCH]}var L,M,T,r,E,t,o,F,O,K,m,H;Ext.each(n,function(V,U,W){var X=V[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[X]=="conceptWikiValue"){L=V[LDA.helper.LDAConstants.LDA_ABOUT];M=V.prefLabel;T=V[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[X]=="chemspiderValue"){r=V[LDA.helper.LDAConstants.LDA_ABOUT];csid=r.split("/").pop();E=V.inchi;t=V.inchikey;o=V.smiles;F=V[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[X]=="drugbankValue"){O=V[LDA.helper.LDAConstants.LDA_ABOUT];K=V.drugType;m=V.genericName;H=V[LDA.helper.LDAConstants.LDA_ABOUT]}}}});var J=Q[LDA.helper.LDAConstants.LDA_ON_ASSAY];if(J!=null){var R=J[LDA.helper.LDAConstants.LDA_ABOUT];var S=J.target}if(S!=null){var w;try{w=S.pop()}catch(v){w=S}var A=w.title;var z=w.target_organisms;var y=w.concatenatedURIs}var C=Q.activity_type;var B=Q.standardValue;var D=Q.standardUnits;var p=Q.relation;var q=Ext.create("LDA.model.PharmacologyPaginatedModel",{page_uri:k,next_page:e,previous_page:a,page_size:g,start_index:j,compound_inchikey:t,compound_drug_type:K,compound_generic_name:m,target_title:A,target_concatenated_uris:y,compound_inchikey_src:F,compound_drug_type_src:H,compound_generic_name_src:H,target_title_src:G,target_concatenated_uris_src:G,chembl_activity_uri:s,chembl_compound_uri:u,compound_full_mwt:N,cw_compound_uri:L,compound_pref_label:M,cs_compound_uri:r,csid:csid,compound_inchi:E,compound_smiles:o,chembl_assay_uri:R,chembl_target_uri:undefined,target_organism:z,target_pref_label:undefined,assay_organism:undefined,activity_relation:p,activity_standard_units:D,activity_standard_value:B,activity_activity_type:C,compound_full_mwt_src:G,compound_pref_label_src:T,compound_inchi_src:F,compound_smiles_src:F,target_organism_src:G,target_pref_label_src:undefined,assay_organism_src:G,activity_relation_src:G,activity_standard_units_src:G,activity_standard_value_src:G,activity_activity_type_src:G});c.push(q)});var b=this.total_count;return new Ext.data.ResultSet({total:b,count:c.length,records:c,success:true,message:"loaded"})}});Ext.define("LDA.view.grids.CompoundPharmacologyPaginatedGrid",{extend:"Ext.grid.Panel",alias:"widget.CompoundPharmacologyPaginatedGrid",store:Ext.create("LDA.store.CompoundPharmacologyPaginatedStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Page URI",dataIndex:"page_uri"},{header:"Next Page URI",dataIndex:"next_page"},{header:"Previous Page URI",dataIndex:"previous_page"},{header:"Page Size",dataIndex:"page_size"},{header:"Start Index",dataIndex:"start_index"},{header:"InchiKey",dataIndex:"compound_inchikey"},{header:"Drug Type",dataIndex:"compound_drug_type"},{header:"Generic Name",dataIndex:"compound_generic_name"},{header:"Target Title",dataIndex:"target_title"},{header:"Target Concatenated URIs",dataIndex:"target_concatenated_uris"},{header:"ChEMBL Activity URI",dataIndex:"chembl_activity_uri"},{header:"ChEMBL Compound URI",dataIndex:"chembl_compound_uri"},{header:"Compound Full Molecular Weight",dataIndex:"compound_full_mwt"},{header:"ConceptWiki Compound URI",dataIndex:"cw_compound_uri"},{header:"Compound Label",dataIndex:"compound_pref_label"},{header:"ChemSpider Compound URI",dataIndex:"cs_compound_uri"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Smiles",dataIndex:"compound_smiles"},{header:"ChEMBL Assay URI",dataIndex:"chembl_assay_uri"},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Target Label",dataIndex:"target_pref_label"},{header:"Activity Type",dataIndex:"activity_activity_type"},{header:"Activity Relation",dataIndex:"activity_relation"},{header:"Activity Value",dataIndex:"activity_standard_value"},{header:"Activity Units",dataIndex:"activity_standard_units"}]}});Ext.define("LDA.store.TargetPharmacologyCountStore",{extend:"LDA.store.basestores.FilteringStore",model:"LDA.model.PharmacologyCountModel",storeId:"TargetPharmacologyCountStore",countNode:"targetPharmacologyTotalResults",BASE_URL:"http://ops.few.vu.nl/target/pharmacology/count?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.TargetPharmacologyCountReader");this.callParent(b)}});Ext.define("LDA.helper.TargetPharmacologyCountReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){var b=d.result["primaryTopic"][LDA.helper.LDAConstants.LDA_TARGET_PHARMACOLOGY_COUNT];var c=d.result["primaryTopic"][LDA.helper.LDAConstants.LDA_ABOUT];var a=Ext.create("LDA.model.PharmacologyCountModel",{count:b,uri:c});return new Ext.data.ResultSet({total:1,count:1,records:[a],success:true,message:"loaded"})}});Ext.define("LDA.view.grids.TargetPharmacologyCountGrid",{extend:"Ext.grid.Panel",alias:"widget.TargetPharmacologyCountGrid",store:Ext.create("LDA.store.TargetPharmacologyCountStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Target URI",dataIndex:"uri",width:400},{header:"Pharmacology Count",dataIndex:"count",width:60}]}});Ext.define("LDA.helper.TargetReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(e){var f=e[LDA.helper.LDAConstants.LDA_RESULT][LDA.helper.LDAConstants.LDA_PRIMARY_TOPIC];var c=f[LDA.helper.LDAConstants.LDA_EXACT_MATCH];var h;var g;Ext.each(c,function(k,j,l){var m=k[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[m]=="chemblValue"){h=k}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[m]=="drugbankValue"){g=k}}});var d;if(h!=null){d=h[LDA.helper.LDAConstants.LDA_IN_DATASET]}if(g!=null){var b=g[LDA.helper.LDAConstants.LDA_IN_DATASET]}var a=Ext.create("LDA.model.TargetModel",{cw_target_uri:f[LDA.helper.LDAConstants.LDA_ABOUT],chembl_target_uri:h!=null?h[LDA.helper.LDAConstants.LDA_ABOUT]:null,drugbank_target_uri:g!=null?g[LDA.helper.LDAConstants.LDA_ABOUT]:null,label:h!=null?h.label:null,label_src:d,keywords:h!=null?h.keyword:null,keywords_src:d,description:h!=null?h.description:null,description_src:d,target_type:h!=null?h.target_type:null,target_type_src:d,organism:h!=null?h.organism:null,organism_src:d,synonyms:h!=null?h.synonyms:null,synonyms_src:d,cellular_location:g!=null?g.cellularLocation:null,cellular_location_src:b,molecular_weight:g!=null?g.molecularWeight:null,molecular_weight_src:b,number_of_residues:g!=null?g.numberOfResidues:null,number_of_residues_src:b,pdb_id_page:g!=null?g.pdbIdPage:null,pdb_id_page_src:b,specific_function:g!=null?g.specificFunction:null,specific_function_src:b,theoretical_pi:g!=null?g.theoreticalPi:null,theoretical_pi_src:b});return new Ext.data.ResultSet({total:1,count:1,records:[a],success:true,message:"loaded"})}});Ext.define("LDA.view.grids.TargetGrid",{extend:"Ext.grid.Panel",alias:"widget.TargetGrid",store:Ext.create("LDA.store.TargetStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"ConceptWiki Target URI",dataIndex:"cw_target_uri",width:100},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri",width:100},{header:"DrugBank Target URI",dataIndex:"drugbank_target_uri",width:100},{header:"Name",dataIndex:"label",width:100},{header:"Keywords",dataIndex:"keywords",width:100},{header:"Description",dataIndex:"description",width:100},{header:"Target Type",dataIndex:"target_type",width:100},{header:"Organism",dataIndex:"organism",width:100},{header:"Synonyms",dataIndex:"synonyms",width:100},{header:"Cellular Location",dataIndex:"cellular_location",width:100},{header:"Molecular Weight",dataIndex:"molecular_weight",width:100},{header:"Number of Residues",dataIndex:"number_of_residues",width:100},{header:"PDB ID",dataIndex:"pdb_id_page",width:100},{header:"Specific Function",dataIndex:"specific_function",width:100},{header:"Theoretical Pi",dataIndex:"theoretical_pi",width:100}]}});Ext.define("LDA.store.TargetPharmacologyPaginatedStore",{extend:"LDA.store.basestores.PaginatedFilteringStore",model:"LDA.model.PharmacologyPaginatedModel",storeId:"TargetPharmacologyPaginatedStore",BASE_URL:"http://ops.few.vu.nl/target/pharmacology/pages?",constructor:function(a,b){console.log("TargetPharmacologyPaginatedStore: constructor()");this.proxy.reader=Ext.create("LDA.helper.TargetPharmacologyPaginatedReader");this.callParent(b)}});Ext.define("LDA.helper.TargetPharmacologyPaginatedReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){var h=this;var c=new Array();var l=d[LDA.helper.LDAConstants.LDA_RESULT];var k=l[LDA.helper.LDAConstants.LDA_ABOUT];var e=l[LDA.helper.LDAConstants.LDA_PAGINATED_NEXT];var a=l[LDA.helper.LDAConstants.LDA_PAGINATED_PREVIOUS];var g=l[LDA.helper.LDAConstants.LDA_PAGINATED_PAGE_SIZE];var j=l[LDA.helper.LDAConstants.LDA_PAGINATED_START_INDEX];var f=l[LDA.helper.LDAConstants.LDA_ITEMS];if(f==null){Ext.Error.raise({msg:"There are no items in the response"})}Ext.each(f,function(D,E,B){var q=D[LDA.helper.LDAConstants.LDA_ABOUT];var C=D[LDA.helper.LDAConstants.LDA_IN_DATASET];var z=D[LDA.helper.LDAConstants.LDA_FOR_MOLECULE];var o;var V;var R;if(z!=null){o=z[LDA.helper.LDAConstants.LDA_ABOUT];V=z.full_mwt;R=z[LDA.helper.LDAConstants.LDA_EXACT_MATCH]}var F,P,U,L,y,N,T,r,p,I,Q,H,m;Ext.each(R,function(X,W,Y){var Z=X[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Z]=="conceptWikiValue"){F=X[LDA.helper.LDAConstants.LDA_ABOUT];P=X.prefLabel;U=X[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Z]=="chemspiderValue"){L=X[LDA.helper.LDAConstants.LDA_ABOUT];m=L.split("/").pop();y=X.inchi;N=X.inchikey;T=X.smiles;r=X[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Z]=="drugbankValue"){p=X[LDA.helper.LDAConstants.LDA_ABOUT];I=X.drugType;Q=X.genericName;H=X[LDA.helper.LDAConstants.LDA_ABOUT]}}}});var w=D[LDA.helper.LDAConstants.LDA_ON_ASSAY];var v;var u;var n;if(w!=null){v=w[LDA.helper.LDAConstants.LDA_ABOUT];u=w.assay_organism;n=w.target}var M;var s;var x;var G;var A;if(n!=null){M=n[LDA.helper.LDAConstants.LDA_ABOUT];s=n.prefLabel;x=s;G=n.assay_organism;A=n.concatenatedURIs}var J=D.activity_type;var O=D.standardValue;var S=D.standardUnits;var t=D.relation;var K=Ext.create("LDA.model.PharmacologyPaginatedModel",{page_uri:k,next_page:e,previous_page:a,page_size:g,start_index:j,compound_inchikey:N,compound_drug_type:I,compound_generic_name:Q,target_title:x,target_concatenated_uris:A,compound_inchikey_src:r,compound_drug_type_src:H,compound_generic_name_src:H,target_title_src:C,target_concatenated_uris_src:C,chembl_activity_uri:q,chembl_compound_uri:o,compound_full_mwt:V,cw_compound_uri:F,compound_pref_label:P,cs_compound_uri:L,csid:m,compound_inchi:y,compound_smiles:T,chembl_assay_uri:v,chembl_target_uri:M,target_organism:G,target_pref_label:s,assay_organism:u,activity_relation:t,activity_standard_units:S,activity_standard_value:O,activity_activity_type:J,compound_full_mwt_src:C,compound_pref_label_src:U,compound_inchi_src:r,compound_smiles_src:r,target_organism_src:C,target_pref_label_src:U,assay_organism_src:C,activity_relation_src:C,activity_standard_units_src:C,activity_standard_value_src:C,activity_activity_type_src:C});c.push(K)});var b=this.total_count;return new Ext.data.ResultSet({total:b,count:c.length,records:c,success:true,message:"loaded"})}});Ext.define("LDA.view.grids.TargetPharmacologyPaginatedGrid",{extend:"Ext.grid.Panel",alias:"widget.TargetPharmacologyPaginatedGrid",store:Ext.create("LDA.store.TargetPharmacologyPaginatedStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Page URI",dataIndex:"page_uri"},{header:"Next Page URI",dataIndex:"next_page"},{header:"Previous Page URI",dataIndex:"previous_page"},{header:"Page Size",dataIndex:"page_size"},{header:"Start Index",dataIndex:"start_index"},{header:"InchiKey",dataIndex:"compound_inchikey"},{header:"Drug Type",dataIndex:"compound_drug_type"},{header:"Generic Name",dataIndex:"compound_generic_name"},{header:"Target Title",dataIndex:"target_title"},{header:"Target Concatenated URIs",dataIndex:"target_concatenated_uris"},{header:"ChEMBL Activity URI",dataIndex:"chembl_activity_uri"},{header:"ChEMBL Compound URI",dataIndex:"chembl_compound_uri"},{header:"Compound Full Molecular Weight",dataIndex:"compound_full_mwt"},{header:"ConceptWiki Compound URI",dataIndex:"cw_compound_uri"},{header:"Compound Label",dataIndex:"compound_pref_label"},{header:"ChemSpider Compound URI",dataIndex:"cs_compound_uri"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Smiles",dataIndex:"compound_smiles"},{header:"ChEMBL Assay URI",dataIndex:"chembl_assay_uri"},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Target Label",dataIndex:"target_pref_label"},{header:"Activity Type",dataIndex:"activity_activity_type"},{header:"Activity Relation",dataIndex:"activity_relation"},{header:"Activity Value",dataIndex:"activity_standard_value"},{header:"Activity Units",dataIndex:"activity_standard_units"}]}});Ext.define("LDA.store.TargetPharmacologyStore",{extend:"LDA.store.basestores.FilteringStore",model:"LDA.model.PharmacologyModel",storeId:"TargetPharmacologyStore",BASE_URL:"http://ops.few.vu.nl/target/pharmacology?",proxy:{type:"jsonp",noCache:false,startParam:undefined,limitParam:undefined,pageParam:undefined,callbackKey:"_callback"},constructor:function(a,b){this.proxy.reader=Ext.create("LDA.helper.TargetPharmacologyReader");this.callParent(b)}});Ext.define("LDA.helper.TargetPharmacologyReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(j){var m=this;var f=new Array();var n=j[LDA.helper.LDAConstants.LDA_RESULT][LDA.helper.LDAConstants.LDA_PRIMARY_TOPIC];var d=n[LDA.helper.LDAConstants.LDA_EXACT_MATCH];var b=d[1];var l=n[LDA.helper.LDAConstants.LDA_ABOUT];var e=b[LDA.helper.LDAConstants.LDA_ABOUT];var k=b[LDA.helper.LDAConstants.LDA_IN_DATASET];var h=b.title;var g=b.assay_organism;var a=n.prefLabel;var c=b[LDA.helper.LDAConstants.LDA_TARGET_OF_ASSAY];Ext.each(c,function(r,q,t){var p=r[LDA.helper.LDAConstants.LDA_ABOUT];var s=r.assay_organism;var o=r[LDA.helper.LDAConstants.LDA_ASSAY_OF_ACTIVITY];Ext.each(o,function(y,E,u){var A=y[LDA.helper.LDAConstants.LDA_ABOUT];var N=y.activity_type;var F=y.relation;var O=y.standardValue;var P=y.standardUnits;var M=y[LDA.helper.LDAConstants.LDA_FOR_MOLECULE];var R=M[LDA.helper.LDAConstants.LDA_EXACT_MATCH];var C=M[LDA.helper.LDAConstants.LDA_ABOUT];var B=undefined;var Q=undefined;if(R.length==2){var G=R[0][LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[G]=="chemspiderValue"){B=R[0];Q=R[1]}else{B=R[1];Q=R[0]}}var D=M.full_mwt;var L=M.num_ro5_violations;if(B){var z=B[LDA.helper.LDAConstants.LDA_ABOUT];var H=B[LDA.helper.LDAConstants.LDA_IN_DATASET];var v=B.inchi;var J=B.smiles}if(Q){var I=Q[LDA.helper.LDAConstants.LDA_ABOUT];var w=Q[LDA.helper.LDAConstants.LDA_IN_DATASET];var K=Q.prefLabel}var x=new LDA.model.PharmacologyModel({cs_compound_uri:z,cw_compound_uri:I,chembl_compound_uri:C,drugbank_compound_uri:undefined,cw_target_uri:l,chembl_target_uri:e,drugbank_target_uri:undefined,chembl_assay_uri:p,chembl_activity_uri:A,target_preflabel:a,target_preflabel_src:w,target_title:h,target_title_src:k,target_organism:g,target_organism_src:k,compound_uuid:undefined,compound_uuid_src:undefined,compound_drug_type:undefined,compound_drug_type_src:undefined,compound_generic_name:undefined,compound_generic_name_src:undefined,compound_full_mwt:D,compound_full_mwt_src:k,compound_num_ro5_violations:L,compound_num_ro5_violations_src:k,compound_inchi:v,compound_inchi_src:H,compound_inchi_key:undefined,compound_inchi_key_src:undefined,compound_smiles:J,compound_smiles_src:H,compound_preflabel:K,compound_preflabel_src:w,assay_organism:s,assay_organism_src:k,activity_relation:F,activity_relation_src:k,activity_standard_units:P,activity_standard_units_src:k,activity_standard_value:O,activity_standard_value_src:k,activity_activity_type:N,activity_activity_type_src:k});f.push(x)})});return new Ext.data.ResultSet({total:f.length,count:f.length,records:f,success:true,message:"loaded"})}});Ext.define("LDA.view.grids.TargetPharmacologyGrid",{extend:"Ext.grid.Panel",alias:"widget.TargetPharmacologyGrid",store:Ext.create("LDA.store.TargetPharmacologyStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"ConceptWiki Target URI",dataIndex:"cw_target_uri"},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri"},{header:"DrugBank Target URI",dataIndex:"drugbank_target_uri"},{header:"ConceptWiki Compound URI",dataIndex:"cw_compound_uri"},{header:"Chemspider Compound URI",dataIndex:"cs_compound_uri"},{header:"ChEMBL Compound URI",dataIndex:"chembl_compound_uri"},{header:"DrugBank Compound URI",dataIndex:"drugbank_compound_uri"},{header:"ChEMBL Assay URI",dataIndex:"chembl_assay_uri"},{header:"ChEMBL Activity URI",dataIndex:"chembl_activity_uri"},{header:"Target Preferred Label",dataIndex:"target_preflabel"},{header:"Target Label",dataIndex:"target_title"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Compound Label",dataIndex:"compound_preflabel"},{header:"Compound Drug Type",dataIndex:"compound_drug_type"},{header:"Compound Generic Name",dataIndex:"compound_generic_name"},{header:"Compound Full Molecular Weight",dataIndex:"compound_full_mwt"},{header:"Compound Rule of 5 violations",dataIndex:"compound_num_ro5_violations"},{header:"Compound Inchi",dataIndex:"compound_inchi"},{header:"Compound Inchi Key",dataIndex:"compound_inchi_key"},{header:"Compound SMILES",dataIndex:"compound_smiles"},{header:"Assay Organism",dataIndex:"assay_organism"},{header:"Activity Type",dataIndex:"activity_activity_type"},{header:"Activity Relation",dataIndex:"activity_relation"},{header:"Activity Value",dataIndex:"activity_standard_value"},{header:"Activity Units",dataIndex:"activity_standard_units"}]}});Ext.define("LDA.store.EnzymeFamilyPaginatedStore",{extend:"LDA.store.basestores.PaginatedFilteringStore",model:"LDA.model.PharmacologyPaginatedModel",storeId:"EnzymeFamilyPaginatedStore",BASE_URL:"http://ops.few.vu.nl/target/enzyme/pharmacology/pages?",constructor:function(a,b){console.log("EnzymeFamilyPaginatedStore: constructor()");this.proxy.reader=Ext.create("LDA.helper.EnzymeFamilyPaginatedReader");this.callParent(b)}});Ext.define("LDA.helper.EnzymeFamilyPaginatedReader",{extend:"Ext.data.reader.Json",requires:["LDA.helper.LDAConstants"],readRecords:function(d){console.log("LDA.helper.EnzymeFamilyPaginatedReader: readRecords()");console.log(d);var h=this;var c=new Array();var l=d[LDA.helper.LDAConstants.LDA_RESULT];var k=l[LDA.helper.LDAConstants.LDA_ABOUT];var e=l[LDA.helper.LDAConstants.LDA_PAGINATED_NEXT];var a=l[LDA.helper.LDAConstants.LDA_PAGINATED_PREVIOUS];var g=l[LDA.helper.LDAConstants.LDA_PAGINATED_PAGE_SIZE];var j=l[LDA.helper.LDAConstants.LDA_PAGINATED_START_INDEX];var f=l[LDA.helper.LDAConstants.LDA_ITEMS];Ext.each(f,function(R,w,I){console.log(w);var t=R[LDA.helper.LDAConstants.LDA_ABOUT];var G=R[LDA.helper.LDAConstants.LDA_IN_DATASET];var Q=R[LDA.helper.LDAConstants.LDA_FOR_MOLECULE];if(Q!=null){var v=Q[LDA.helper.LDAConstants.LDA_ABOUT];var N=Q.full_mwt;var o=Q[LDA.helper.LDAConstants.LDA_EXACT_MATCH]}var L,M,U,s,D,u,p,F,P,K,m,H;if(Q!=null){Ext.each(o,function(W,V,X){var Y=W[LDA.helper.LDAConstants.LDA_IN_DATASET];if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Y]=="conceptWikiValue"){L=W[LDA.helper.LDAConstants.LDA_ABOUT];M=W.prefLabel;U=W[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Y]=="chemspiderValue"){s=W[LDA.helper.LDAConstants.LDA_ABOUT];csid=s.split("/").last();D=W.inchi;u=W.inchikey;p=W.smiles;F=W[LDA.helper.LDAConstants.LDA_IN_DATASET]}else{if(LDA.helper.LDAConstants.LDA_SRC_CLS_MAPPINGS[Y]=="drugbankValue"){P=W[LDA.helper.LDAConstants.LDA_ABOUT];K=W.drugType;m=W.genericName;H=W[LDA.helper.LDAConstants.LDA_ABOUT]}}}})}var J=R[LDA.helper.LDAConstants.LDA_ON_ASSAY];if(J!=null){var S=J[LDA.helper.LDAConstants.LDA_ABOUT];var n=J.assay_organism;var T=J.target;if(T!=null){var E=T[LDA.helper.LDAConstants.LDA_ABOUT];var O=T.prefLabel;var z=T.title;var y=T.assay_organism;var x=T.concatenatedURIs}}var B=R.activity_type;var A=R.standardValue;var C=R.standardUnits;var q=R.relation;var r=Ext.create("LDA.model.PharmacologyPaginatedModel",{page_uri:k,next_page:e,previous_page:a,page_size:g,start_index:j,compound_inchikey:u,compound_drug_type:K,compound_generic_name:m,target_title:z,target_concatenated_uris:x,compound_inchikey_src:F,compound_drug_type_src:H,compound_generic_name_src:H,target_title_src:G,target_concatenated_uris_src:G,chembl_activity_uri:t,chembl_compound_uri:v,compound_full_mwt:N,cw_compound_uri:L,compound_pref_label:M,cs_compound_uri:s,csid:csid,compound_inchi:D,compound_smiles:p,chembl_assay_uri:S,chembl_target_uri:E,target_organism:y,target_pref_label:O,assay_organism:n,activity_relation:q,activity_standard_units:C,activity_standard_value:A,activity_activity_type:B,compound_full_mwt_src:G,compound_pref_label_src:U,compound_inchi_src:F,compound_smiles_src:F,target_organism_src:G,target_pref_label_src:U,assay_organism_src:G,activity_relation_src:G,activity_standard_units_src:G,activity_standard_value_src:G,activity_activity_type_src:G});c.push(r)});var b=this.total_count;return new Ext.data.ResultSet({total:b,count:c.length,records:c,success:true,message:"loaded"})}});Ext.define("LDA.view.grids.EnzymeFamilyPaginatedGrid",{extend:"Ext.grid.Panel",alias:"widget.EnzymeFamilyPaginatedGrid",store:Ext.create("LDA.store.EnzymeFamilyPaginatedStore"),loadMask:true,columns:{defaults:{renderer:function(g,b,d,e,j,h,f){if(LDAProvenanceMode!=LDA_PROVENANCE_OFF){var c=this.columns[j].dataIndex;c+="_src";var a=d.data[c];var k=LDA_SRC_CLS_MAPPINGS[a];if(!k){k="defaultValue"}k+=LDAProvenanceMode;if(LDAProvenanceMode==LDA_PROVENANCE_COLOUR){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_ICON){return'<div class="'+k+'">'+g+"</div>"}else{if(LDAProvenanceMode==LDA_PROVENANCE_TEXT){return'<div class="'+k+'">'+g+" ("+a+")</div>"}}}}else{return g}}},items:[{header:"Page URI",dataIndex:"page_uri"},{header:"Next Page URI",dataIndex:"next_page"},{header:"Previous Page URI",dataIndex:"previous_page"},{header:"Page Size",dataIndex:"page_size"},{header:"Start Index",dataIndex:"start_index"},{header:"InchiKey",dataIndex:"compound_inchikey"},{header:"Drug Type",dataIndex:"compound_drug_type"},{header:"Generic Name",dataIndex:"compound_generic_name"},{header:"Target Title",dataIndex:"target_title"},{header:"Target Concatenated URIs",dataIndex:"target_concatenated_uris"},{header:"ChEMBL Activity URI",dataIndex:"chembl_activity_uri"},{header:"ChEMBL Compound URI",dataIndex:"chembl_compound_uri"},{header:"Compound Full Molecular Weight",dataIndex:"compound_full_mwt"},{header:"ConceptWiki Compound URI",dataIndex:"cw_compound_uri"},{header:"Compound Label",dataIndex:"compound_pref_label"},{header:"ChemSpider Compound URI",dataIndex:"cs_compound_uri"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Smiles",dataIndex:"compound_smiles"},{header:"ChEMBL Assay URI",dataIndex:"chembl_assay_uri"},{header:"ChEMBL Target URI",dataIndex:"chembl_target_uri"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Target Label",dataIndex:"target_pref_label"},{header:"Activity Type",dataIndex:"activity_activity_type"},{header:"Activity Relation",dataIndex:"activity_relation"},{header:"Activity Value",dataIndex:"activity_standard_value"},{header:"Activity Units",dataIndex:"activity_standard_units"}]}});Ext.define("LSP.model.GuiComponent",{extend:"Ext.data.Model",fields:["xtype","url","id","text","home"]});Ext.define("LSP.view.dropdowns.conceptWikiProteinLookup",{extend:"Ext.form.ComboBox",alias:"widget.conceptWikiProteinLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"concept_label"},{type:"string",name:"concept_url"},{type:"string",name:"define_url"},{type:"string",name:"concept_uuid"},{type:"string",name:"concept_alt_labels"},{type:"string",name:"tag_label"},{type:"string",name:"tag_uuid"},{type:"string",name:"match"}],proxy:{type:"ajax",api:{read:"/concept_wiki_api_calls/protein_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"concept_url",displayField:"concept_label",name:"protein_uri",minChars:4,hideTrigger:true,forceSelection:true,allowBlank:false,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:700,fieldLabel:"Protein name",labelWidth:120,listConfig:{loadingText:"Searching...",emptyText:"No matching proteins found.",getInnerTpl:function(){return'<p><span style="font-family: verdana; color: grey; "><small>Match: {match}</small></span><br/><b>{concept_label}</b> <a href="{define_url}" target="_blank">(definition)</a></p>'}}});Ext.define("Ext.ux.DataView.Animated",{defaults:{duration:750,idProperty:"id"},constructor:function(a){Ext.apply(this,a||{},this.defaults)},init:function(a){this.dataview=a;var c=this.idProperty,b=a.store;a.blockRefresh=true;a.updateIndexes=Ext.Function.createSequence(a.updateIndexes,function(){this.getTargetEl().select(this.itemSelector).each(function(f,g,e){f.id=f.dom.id=Ext.util.Format.format("{0}-{1}",a.id,b.getAt(e).internalId)},this)},a);this.dataviewID=a.id;this.cachedStoreData={};this.cacheStoreData(b.data||b.snapshot);a.on("resize",function(){var e=a.store;if(e.getCount()>0){}},this);a.store.on("datachanged",d,this);function d(o){var m=a.getTargetEl(),h=o.getAt(0),q=this.getAdded(o),y=this.getRemoved(o),j=this.getRemaining(o),v=Ext.apply({},j,q);Ext.each(y,function(D){var E=this.dataviewID+"-"+D.internalId;Ext.fly(E).animate({remove:false,duration:e,opacity:0,useDisplay:true,callback:function(){Ext.fly(E).setDisplayed(false)}})},this);if(h==undefined){this.cacheStoreData(o);return}this.cacheStoreData(o);var g=Ext.get(this.dataviewID+"-"+h.internalId);if(!g){a.refresh();return true}var A=o.getCount(),l=g.getMargin("lr")+g.getWidth(),w=g.getMargin("bt")+g.getHeight(),s=m.getWidth(),f=Math.floor(s/l),r=Math.ceil(A/f),B=Math.ceil(this.getExistingCount()/f);var k={},C={},t={};Ext.iterate(j,function(F,E){var F=E.internalId,D=t[F]=Ext.get(this.dataviewID+"-"+F);k[F]={top:D.getTop()-m.getTop()-D.getMargin("t")-m.getPadding("t"),left:D.getLeft()-m.getLeft()-D.getMargin("l")-m.getPadding("l")}},this);m.applyStyles({display:"block",position:"relative"});Ext.iterate(j,function(G,F){var D=k[G],E=t[G];if(E.getStyle("position")!="absolute"){t[G].applyStyles({position:"absolute",left:D.left+"px",top:D.top+"px"})}});var p=0;Ext.iterate(o.data.items,function(F){var J=F.internalId,E=t[J];var D=p%f,I=Math.floor(p/f),H=I*w,G=D*l;C[J]={top:H,left:G};p++},this);var u=new Date(),e=this.duration,n=this.dataviewID;var z=function(){var M=new Date()-u,O=M/e,D;if(O>=1){for(D in C){Ext.fly(n+"-"+D).applyStyles({top:C[D].top+"px",left:C[D].left+"px"})}Ext.TaskManager.stop(x)}else{for(D in C){if(!j[D]){continue}var G=k[D],J=C[D],H=G.top,K=J.top,F=G.left,L=J.left,I=O*Math.abs(H-K),N=O*Math.abs(F-L),P=H>K?H-I:H+I,E=F>L?F-N:F+N;Ext.fly(n+"-"+D).applyStyles({top:P+"px",left:E+"px"}).setDisplayed(true)}}};var x={run:z,interval:20,scope:this};Ext.TaskManager.start(x);Ext.iterate(q,function(E,D){Ext.fly(this.dataviewID+"-"+D.internalId).applyStyles({top:C[D.internalId].top+"px",left:C[D.internalId].left+"px"}).setDisplayed(true);Ext.fly(this.dataviewID+"-"+D.internalId).animate({remove:false,duration:e,opacity:1})},this);this.cacheStoreData(o)}},cacheStoreData:function(a){this.cachedStoreData={};a.each(function(b){this.cachedStoreData[b.internalId]=b},this)},getExisting:function(){return this.cachedStoreData},getExistingCount:function(){var c=0,b=this.getExisting();for(var a in b){c++}return c},getAdded:function(a){var b={};a.each(function(c){if(this.cachedStoreData[c.internalId]==undefined){b[c.internalId]=c}},this);return b},getRemoved:function(a){var b=[],c;for(c in this.cachedStoreData){if(a.findBy(function(d){return d.internalId==c})==-1){b.push(this.cachedStoreData[c])}}return b},getRemaining:function(a){var b={};a.each(function(c){if(this.cachedStoreData[c.internalId]!=undefined){b[c.internalId]=c}},this);return b}});Ext.getHead().insertHtml("beforeEnd",'<style type="text/css">.x-selectable, .x-selectable * {    -khtml-user-select: text !important;    -moz-user-select: text !important;}</style>');Ext.require("Ext.view.Table",function(){Ext.override(Ext.view.Table,{afterrender:function(){var a=this;a.callParent();a.mon(a.el,{scroll:a.fireBodyScroll,scope:a});if(a.getFeature("selectable")===undefined){a.el.unselectable()}a.attachEventsForFeatures()}})});Ext.require("Ext.grid.feature.Feature",function(){Ext.define("LSP.view.dynamicgrid.feature.selectable",{extend:"Ext.grid.feature.Feature",alias:"feature.selectable",mutateMetaRowTpl:function(b){var a,c=b.length;for(a=0;a<c;a++){tpl=b[a];tpl=tpl.replace(/x-grid-row/,"x-grid-row x-selectable");tpl=tpl.replace(/x-grid-cell-inner x-unselectable/g,"x-grid-cell-inner");tpl=tpl.replace(/unselectable="on"/g,"");b[a]=tpl}}})});Ext.define("Ext.ux.grid.FiltersFeature",{extend:"Ext.grid.feature.Feature",alias:"feature.filters",uses:["Ext.ux.grid.menu.ListMenu","Ext.ux.grid.menu.RangeMenu","Ext.ux.grid.filter.BooleanFilter","Ext.ux.grid.filter.DateFilter","Ext.ux.grid.filter.ListFilter","Ext.ux.grid.filter.NumericFilter","Ext.ux.grid.filter.StringFilter"],autoReload:true,filterCls:"ux-filtered-column",local:false,menuFilterText:"Filters",paramPrefix:"filter",showMenu:true,stateId:undefined,updateBuffer:500,hasFeatureEvent:false,constructor:function(a){var b=this;a=a||{};Ext.apply(b,a);b.deferredUpdate=Ext.create("Ext.util.DelayedTask",b.reload,b);b.filters=b.createFiltersCollection();b.filterConfigs=a.filters},attachEvents:function(){var c=this,a=c.view,d=a.headerCt,b=c.getGridPanel();c.bindStore(a.getStore(),true);d.on("menucreate",c.onMenuCreate,c);a.on("refresh",c.onRefresh,c);b.on({scope:c,beforestaterestore:c.applyState,beforestatesave:c.saveState,beforedestroy:c.destroy});b.filters=c;b.addEvents("filterupdate")},createFiltersCollection:function(){return Ext.create("Ext.util.MixedCollection",false,function(a){return a?a.dataIndex:null})},createFilters:function(){var h=this,g=h.filters.getCount(),a=h.getGridPanel(),d=h.createFiltersCollection(),e=a.store.model,f=e.prototype.fields,j,c,b;if(g){b={};h.saveState(null,b)}function k(m,l,n){if(m&&(n||l)){j=f.get(m);c={dataIndex:m,type:(j&&j.type&&j.type.type)||"auto"};if(Ext.isObject(l)){Ext.apply(c,l)}d.replace(c)}}Ext.Array.each(h.filterConfigs,function(l){k(l.dataIndex,l)});Ext.Array.each(a.columns,function(l){if(l.filterable===false){d.removeAtKey(l.dataIndex)}else{k(l.dataIndex,l.filter,l.filterable)}});h.removeAll();if(d.items){h.initializeFilters(d.items)}if(g){h.applyState(null,b)}},initializeFilters:function(e){var d=this,f=e.length,b,c,a;for(b=0;b<f;b++){c=e[b];if(c){a=d.getFilterClass(c.type);c=c.menu?c:new a(c);d.filters.add(c);Ext.util.Observable.capture(c,this.onStateChange,this)}}},onMenuCreate:function(c,b){var a=this;a.createFilters();b.on("beforeshow",a.onMenuBeforeShow,a)},onMenuBeforeShow:function(d){var c=this,b,a;if(c.showMenu){b=c.menuItem;if(!b||b.isDestroyed){c.createMenuItem(d);b=c.menuItem}a=c.getMenuFilter();if(a){b.setMenu(a.menu,false);b.setChecked(a.active);b.setDisabled(a.disabled===true)}b.setVisible(!!a);this.sep.setVisible(!!a)}},createMenuItem:function(b){var a=this;a.sep=b.add("-");a.menuItem=b.add({checked:false,itemId:"filters",text:a.menuFilterText,listeners:{scope:a,checkchange:a.onCheckChange,beforecheckchange:a.onBeforeCheck}})},getGridPanel:function(){return this.view.up("gridpanel")},applyState:function(b,e){var d=this,a,c;d.applyingState=true;d.clearFilters();if(e.filters){for(a in e.filters){if(e.filters.hasOwnProperty(a)){c=d.filters.get(a);if(c){c.setValue(e.filters[a]);c.setActive(true)}}}}d.deferredUpdate.cancel();if(d.local){d.reload()}delete d.applyingState;delete e.filters},saveState:function(a,c){var b={};this.filters.each(function(d){if(d.active){b[d.dataIndex]=d.getValue()}});return(c.filters=b)},destroy:function(){var a=this;Ext.destroyMembers(a,"menuItem","sep");a.removeAll();a.clearListeners()},removeAll:function(){if(this.filters){Ext.destroy.apply(Ext,this.filters.items);this.filters.clear()}},bindStore:function(a){var b=this;if(b.store&&b.storeListeners){b.store.un(b.storeListeners)}if(a){b.storeListeners={scope:b};if(b.local){b.storeListeners.load=b.onLoad}else{b.storeListeners["before"+(a.buffered?"prefetch":"load")]=b.onBeforeLoad}a.on(b.storeListeners)}else{delete b.storeListeners}b.store=a},getMenuFilter:function(){var a=this.view.headerCt.getMenu().activeHeader;return a?this.filters.get(a.dataIndex):null},onCheckChange:function(a,b){this.getMenuFilter().setActive(b)},onBeforeCheck:function(a,b){return !b||this.getMenuFilter().isActivatable()},onStateChange:function(d,b){if(d!=="serialize"){var c=this,a=c.getGridPanel();if(b==c.getMenuFilter()){c.menuItem.setChecked(b.active,false)}if((c.autoReload||c.local)&&!c.applyingState){c.deferredUpdate.delay(c.updateBuffer)}c.updateColumnHeadings();if(!c.applyingState){a.saveState()}a.fireEvent("filterupdate",c,b)}},onBeforeLoad:function(a,b){b.params=b.params||{};this.cleanParams(b.params);var c=this.buildQuery(this.getFilterData());Ext.apply(b.params,c)},onLoad:function(a){a.filterBy(this.getRecordFilter())},onRefresh:function(){this.updateColumnHeadings()},updateColumnHeadings:function(){var a=this,b=a.view.headerCt;if(b){b.items.each(function(d){var c=a.getFilter(d.dataIndex);d[c&&c.active?"addCls":"removeCls"](a.filterCls)})}},reload:function(){var b=this,a=b.view.getStore();if(b.local){a.clearFilter(true);a.filterBy(b.getRecordFilter());a.sort()}else{b.deferredUpdate.cancel();if(a.buffered){a.pageMap.clear()}a.loadPage(1)}},getRecordFilter:function(){var c=[],a,b;this.filters.each(function(d){if(d.active){c.push(d)}});a=c.length;return function(d){for(b=0;b<a;b++){if(!c[b].validateRecord(d)){return false}}return true}},addFilter:function(a){var f=this,c=f.getGridPanel().columns,b,h,e,g,d;for(b=0,h=c.length;b<h;b++){e=c[b];if(e.dataIndex===a.dataIndex){e.filter=a}}if(f.view.headerCt.menu){f.createFilters()}else{f.view.headerCt.getMenu()}for(b=0,g=f.filters.items.length;b<g;b++){d=f.filters.items[b];if(d.dataIndex===a.dataIndex){return d}}},addFilters:function(c){if(c){var b=this,a,d;for(a=0,d=c.length;a<d;a++){b.addFilter(c[a])}}},getFilter:function(a){return this.filters.get(a)},clearFilters:function(){this.filters.each(function(a){a.setActive(false)})},getFilterData:function(){var c=[],b,a;this.filters.each(function(e){if(e.active){var g=[].concat(e.serialize());for(b=0,a=g.length;b<a;b++){c.push({field:e.dataIndex,data:g[b]})}}});return c},buildQuery:function(b){var a={},c,h,j,e,k,d,g=b.length;if(!this.encode){for(c=0;c<g;c++){h=b[c];j=[this.paramPrefix,"[",c,"]"].join("");a[j+"[field]"]=h.field;e=j+"[data]";for(k in h.data){a[[e,"[",k,"]"].join("")]=h.data[k]}}}else{d=[];for(c=0;c<g;c++){h=b[c];d.push(Ext.apply({},{field:h.field},h.data))}if(d.length>0){a[this.paramPrefix]=Ext.JSON.encode(d)}}return a},cleanParams:function(c){if(this.encode){delete c[this.paramPrefix]}else{var b,a;b=new RegExp("^"+this.paramPrefix+"[[0-9]+]");for(a in c){if(b.test(a)){delete c[a]}}}},getFilterClass:function(a){switch(a){case"auto":a="string";break;case"int":case"float":a="numeric";break;case"bool":a="boolean";break}return Ext.ClassManager.getByAlias("gridfilter."+a)}});Ext.define("LDA.view.LDAParserView",{extend:"Ext.form.Panel",alias:"widget.LDAParserView",requires:["LDA.view.grids.CompoundPharmacologyCountGrid","LDA.view.grids.CompoundGrid","LDA.view.grids.CompoundPharmacologyGrid","LDA.view.grids.CompoundPharmacologyPaginatedGrid","LDA.view.grids.TargetPharmacologyCountGrid","LDA.view.grids.TargetGrid","LDA.view.grids.TargetPharmacologyGrid","LDA.view.grids.TargetPharmacologyPaginatedGrid","LDA.view.grids.EnzymeFamilyPaginatedGrid"],layout:{type:"vbox"},items:[{xtype:"textfield",fieldLabel:"Compound Store URI",value:"http://www.conceptwiki.org/concept/38932552-111f-4a4e-a46a-4ed1d7bdf9d5",width:600,itemId:"ldacu"},{xtype:"panel",layout:"hbox",items:[{xtype:"CompoundGrid",width:900,height:300,itemId:"ldacg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_c",width:100},{xtype:"button",text:"Log Store Details",action:"log_c",width:100}]}]},{xtype:"textfield",fieldLabel:"Compound Pharmacology Store URI",value:"http://www.conceptwiki.org/concept/38932552-111f-4a4e-a46a-4ed1d7bdf9d5",width:600,itemId:"ldacpu"},{xtype:"panel",layout:"hbox",items:[{xtype:"CompoundPharmacologyGrid",width:900,height:300,itemId:"ldacpg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_cp",width:100},{xtype:"button",text:"Log Store Details",action:"log_cp",width:100}]}]},{xtype:"textfield",fieldLabel:"Compound Pharmacology Paginated Store URI",value:"http://www.conceptwiki.org/concept/38932552-111f-4a4e-a46a-4ed1d7bdf9d5",width:600,itemId:"ldacppu"},{xtype:"panel",layout:"hbox",items:[{xtype:"CompoundPharmacologyPaginatedGrid",width:900,height:300,itemId:"ldacppg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_cpp",width:100},{xtype:"button",text:"Log Store Details",action:"log_cpp",width:100}]}]},{xtype:"textfield",fieldLabel:"Compound Pharmacology Count Store URI",value:"http://www.conceptwiki.org/concept/38932552-111f-4a4e-a46a-4ed1d7bdf9d5",width:600,itemId:"ldacpcu"},{xtype:"panel",layout:"hbox",items:[{xtype:"CompoundPharmacologyCountGrid",width:900,height:300,itemId:"ldacpcg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_cpc",width:100},{xtype:"button",text:"Log Store Details",action:"log_cpc",width:100}]}]},{xtype:"textfield",fieldLabel:"Target Store URI",value:"http://www.conceptwiki.org/concept/59aabd64-bee9-45b7-bbe0-9533f6a1f6bc",width:600,itemId:"ldatu"},{xtype:"panel",layout:"hbox",items:[{xtype:"TargetGrid",width:900,height:300,itemId:"ldatg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_t",width:100},{xtype:"button",text:"Log Store Details",action:"log_t",width:100}]}]},{xtype:"textfield",fieldLabel:"Target Pharmacology Store URI",value:"http://www.conceptwiki.org/concept/59aabd64-bee9-45b7-bbe0-9533f6a1f6bc",width:600,itemId:"ldatpu"},{xtype:"panel",layout:"hbox",items:[{xtype:"TargetPharmacologyGrid",width:900,height:300,itemId:"ldatpg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_tp",width:100},{xtype:"button",text:"Log Store Details",action:"log_tp",width:100}]}]},{xtype:"textfield",fieldLabel:"Target Pharmacology Paginated Store URI",value:"http://www.conceptwiki.org/concept/59aabd64-bee9-45b7-bbe0-9533f6a1f6bc",width:600,itemId:"ldatppu"},{xtype:"panel",layout:"hbox",items:[{xtype:"TargetPharmacologyPaginatedGrid",width:900,height:300,itemId:"ldatppg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_tpp",width:100},{xtype:"button",text:"Log Store Details",action:"log_tpp",width:100}]}]},{xtype:"textfield",fieldLabel:"Target Pharmacology Count Store URI",value:"http://www.conceptwiki.org/concept/59aabd64-bee9-45b7-bbe0-9533f6a1f6bc",width:600,itemId:"ldatpcu"},{xtype:"panel",layout:"hbox",items:[{xtype:"TargetPharmacologyCountGrid",width:900,height:300,itemId:"ldatpcg"},{xtype:"panel",layout:"vbox",items:[{xtype:"button",text:"load",action:"load_tpc",width:100},{xtype:"button",text:"Log Store Details",action:"log_tpc",width:100}]}]}]});Ext.define("LSP.controller.LDAParserController",{extend:"Ext.app.Controller",requires:["LDA.view.LDAParserView"],refs:[{ref:"parserview",selector:"LDAParserView"},{ref:"rta",selector:"#textarea1"},{ref:"pta",selector:"#textarea2"}],init:function(){var a=this;a.control({"LDAParserView button":{click:this.buttonClick}})},buttonClick:function(b,c,a){var g=b.action;var f=g.split("_");if(f.length==2){var e=f[0];var d=f[1];if(e=="load"){this.loadLDAData(d)}else{if(e=="log"){this.logStoreDetails(d)}}}},logStoreDetails:function(e){var c=this.getParserview().down("#lda"+e+"g");var a=c.store;var b=Ext.ComponentQuery.query("#logarea")[0];var d="";b.setValue("");Ext.each(a.data.items,function(f,h,j){console.log(f.id);d="";d=d.concat(f.id+"\n");Ext.iterate(f.data,function(k,l,m){console.log(k+": "+l);d=d.concat(k+": "+l+"\n")});var g=b.getValue();b.setValue(g.concat("\n"+d+"\n"))})},loadLDAData:function(e){var c=this.getParserview().down("#lda"+e+"g");var b=this.getParserview().down("#lda"+e+"u");var d=b.getValue();var a=c.getStore();c.setLoading(true);a.setURI(d);a.load(function(){c.setLoading(false)})},processLDAJSON:function(c,b){var a=new Array();Ext.each(c.result["primaryTopic"]["exactMatch"][2]["activity"],function(e,d,g){var f=new Object();f.type=e.type;f.relation=e.relation;f.standard_value=e.standardValue;f.standard_units=e.standardUnits;a.push(f)});console.log(a);b.setValue(JSON.stringify(a,undefined,2))}});Ext.define("LSP.store.GuiComponents",{extend:"Ext.data.Store",id:"GuiComponents",model:"LSP.model.GuiComponent",autoLoad:true,data:[{url:"users.json",text:"Users",id:3,xtype:"dynamicgrid",home:"Users grid"},{url:"rdf.json",text:"SPARQL",id:5,xtype:"queryform",home:"SPARQL form"},{url:"",text:"Compound by name",id:18,xtype:"CmpdByNameForm",home:"Compound by name"},{url:"",text:"Compound by structure",id:23,xtype:"SimSearchForm",home:"Compound Structure Search"},{url:"",text:"Target by name",id:24,xtype:"TargetByNameForm",home:"Target by name"},{url:"",text:"X-Target by sequence",id:25,xtype:"temp",home:""},{url:"",text:"Pharmacology by Target",id:26,xtype:"PharmByTargetNameForm",home:"Pharmacology by Target Name"},{url:"",text:"Pharmacology by Compound",id:27,xtype:"PharmByCmpdNameForm",home:"Pharmacology by Compound name"},{url:"",text:"Pharmacology by Enzyme family",id:28,xtype:"PharmEnzymeForm",home:"Compounds active against enzyme family"},{url:"",text:"X-Polypharmacology Browser",id:34,xtype:"temp",home:""},{url:"",text:"X-Target Dossier",id:35,xtype:"temp",home:""},{url:"",text:"X-Chem-Bio Navigator",id:36,xtype:"temp",home:""}],});Ext.define("LSP.controller.NavigationTree",{extend:"Ext.app.Controller",stores:["NavigationTree","GuiComponents"],views:["Appmoduletree"],init:function(){}});Ext.define("LSP.view.target_by_name.TargetByNameForm",{extend:"Ext.form.Panel",alias:"widget.TargetByNameForm",closable:true,requires:["LSP.view.dropdowns.conceptWikiProteinLookup","LSP.view.target_by_name.TargetPanel"],layout:{type:"vbox",align:"stretch"},initComponent:function(){this.items=[{xtype:"label",html:'<span style="font-family: verdana; color: grey; ">Hint: Start typing in protein name and species. E.g. "Adenosine receptor A2a (Homo sapiens)"</span>',labelWidth:400,padding:"5 0 0 140"},{xtype:"container",margin:"0 5 5 5",name:"form_fields",layout:{type:"column"},style:"background-color: #fff;",items:[Ext.create("CW.view.ConceptWikiLookup",{xtype:"conceptWikiLookup",fieldLabel:"Protein name",itemId:"targetByNameLookup",name:"protein_uri",cwTagUuid:"eeaec894-d856-4106-9fa1-662b1dc6c6f1"}),{xtype:"button",padding:"5 5 5 5",text:"Search",itemId:"TargetByNameSubmit_id",disabled:true,action:"query_target_by_name"}]},{xtype:"TargetPanel",flex:1}];this.callParent(arguments)}});Ext.define("LSP.controller.TargetByNameForm",{extend:"Ext.app.Controller",models:["LDA.model.TargetModel"],stores:["LDA.store.TargetStore"],views:["target_by_name.TargetByNameForm","target_by_name.TargetPanel"],refs:[{ref:"targetPanel",selector:"TargetPanel"},{ref:"formView",selector:"TargetByNameForm"},{ref:"submitButton",selector:"#TargetByNameSubmit_id"},{ref:"lookup",selector:"#targetByNameLookup"}],init:function(){this.control({"TargetByNameForm button[action=query_target_by_name]":{click:this.submitQuery},"TargetByNameForm conceptWikiLookup":{select:this.enableSubmit},TargetByNameForm:{historyToken:this.handleHistoryToken}})},handleHistoryToken:function(b){console.log("LSP.controller.TargetByNameForm: handleHistoryToken()");var c=this;var e=c.getFormView().down("TargetPanel");if(b.u){var a=this.getLDAStoreTargetStoreStore();if(b.u!=a.proxy.extraParams.uri){a.proxy.extraParams.uri=b.u;c.getFormView().setLoading(true);a.load(function(g,f,h){if(h){console.log("LSP.controller.TargetByNameForm: store is loaded "+h);c.getSubmitButton().enable();e.setValues(g[0]);e.down("#dp").setVisible(true);e.down("#msg").setVisible(false);c.getFormView().setLoading(false)}else{Ext.MessageBox.show({title:"Info",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO});c.getSubmitButton().enable();e.down("#dp").setVisible(false);c.getFormView().setLoading(false)}})}}else{if(b.s){var d=this.getLookup();d.setRawValue(b.s);d.doQuery(b.s)}}},enableSubmit:function(){var b=this.getFormView();var a=this.getSubmitButton();a.enable()},submitQuery:function(b){b.disable();var c=this.getFormView();var a=c.getValues().protein_uri;Ext.History.add("!p=TargetByNameForm&u="+a)}});Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.ux.DataView","/ext/examples/ux/DataView/");Ext.define("LSP.view.dataview.StructureViewer",{extend:"Ext.window.Window",alias:"widget.StructureViewer",requires:["Ext.form.Panel","Ext.util.*","Ext.ux.DataView.Animated"],title:"Structures",layout:"fit",modal:true,autoShow:true,height:570,width:810,initComponent:function(){var b=structureViewStore;var a=Ext.create("Ext.view.View",{deferInitialRefresh:false,store:b,tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="structure_data_view-wrap">','<p height="180">','<img width="128" height="128" src="http://www.chemspider.com/ImagesHandler.ashx?id={csid}&w=128&h=128" alt="CSID:{csid}"/>','<br /><strong>Chemspider id : <a href ="http://inchi.chemspider.com/Chemical-Structure.{csid}.html" target="_blank">{csid}</a></strong>',"</p>","</div>","</tpl>"),plugins:[Ext.create("Ext.ux.DataView.Animated",{duration:550,idProperty:"csid"})],itemSelector:"div.structure_data_view-wrap",overItemCls:"x-view-over_structure_dv",singleSelect:true,autoScroll:true});this.items=[{xtype:"form",padding:"0 0 0 0",border:false,autoScroll:true,style:"background-color: #fff;",items:a}];this.buttons=[{text:"Use structure",action:"commit_structure"},{text:"Cancel",scope:this,handler:this.close}];this.callParent(arguments)}});Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.ux.grid","ext/examples/ux/grid");Ext.define("LSP.view.dynamicgrid.DynamicGrid",{extend:"Ext.grid.Panel",alias:"widget.dynamicgrid",requires:["Ext.grid.RowNumberer","Ext.form.*","Ext.ux.grid.FiltersFeature","Ext.selection.CellModel","LSP.view.dynamicgrid.feature.selectable"],rowNumberer:true,defaultWidth:200,showMenu:function(b,h,c){var f=c.data.compound_pref_label;var a=c.data.target_title;var e=c.data.compound_smiles;if(a){var g=new Ext.menu.Menu({items:[{xtype:"textfield",value:f},{xtype:"textfield",value:a},{xtype:"textfield",value:e}]});var d=new Ext.menu.Menu({items:[{text:"Search for compound by name",itemId:"searchForCompoundByName",iconCls:"menu-search-compound",handler:function(){Ext.History.add("!p=CmpdByNameForm&s="+f)}},{text:"Search for compound by SMILES",itemId:"searchForCompoundBySMILES",iconCls:"menu-search-compound",handler:function(){Ext.History.add("!p=SimSearchForm&sm="+e+"&st=exact")}},{text:"Search for target by name",itemId:"searchForTarget",iconCls:"menu-search-target",handler:function(){Ext.History.add("!p=TargetByNameForm&s="+a)}},{text:"Copy Data",menu:g}]});d.showAt(b,h)}else{var g=new Ext.menu.Menu({items:[{xtype:"textfield",value:f},{xtype:"textfield",value:e}]});var d=new Ext.menu.Menu({items:[{text:"Search for compound by name",itemId:"searchForCompoundByName",iconCls:"menu-search-compound",handler:function(){Ext.History.add("!p=CmpdByNameForm&s="+f)}},{text:"Search for compound by SMILES",itemId:"searchForCompoundBySMILES",iconCls:"menu-search-compound",handler:function(){Ext.History.add("!p=SimSearchForm&sm="+e+"&st=exact")}},{text:"Copy Data",menu:g}]});d.showAt(b,h)}},initComponent:function(){console.log("DynamicGrid: initComponent()");var c=Ext.create("Ext.grid.feature.Grouping",{groupHeaderTpl:'Group: {name} ({rows.length} Item{[values.rows.length > 1 ? "s" : ""]})'});var b={ftype:"filters",encode:true,local:true};var d={ftype:"selectable",id:"selectable"};var a={tbar:[{xtype:"exporterbutton",formatter:"csv",swfPath:"app/view/ux/exporter/downloadify.swf",downloadImage:"app/view/ux/exporter/csv_button.png",itemId:"csvDownload_id",width:117,height:22,hidden:false},{xtype:"tbseparator"},{xtype:"button",text:"Prepare SD-file download",tooltip:"Starts a two steep process to download the SD-file. This may take a while...",itemId:"sdfDownloadProxy_id",iconCls:"icon-sdf",hidden:false,disabled:true},{xtype:"exporterbutton",formatter:"sdf",swfPath:"app/view/ux/exporter/downloadify.swf",downloadImage:"app/view/ux/exporter/sdf_button.png",itemId:"sdfDownload_id",width:111,height:22,hidden:false,disabled:true}],features:[c,b,d]};Ext.apply(this,a);Ext.apply(this.initialConfig,a);this.callParent(arguments)}});Ext.define("LSP.controller.grids.DynamicGrid",{extend:"Ext.app.Controller",views:["dynamicgrid.DynamicGrid"],models:["DynamicGrid"],refs:[{ref:"gridView",selector:"dynamicgrid"}],filters:[],init:function(){console.log("DynamicGrid: init()");this.control({dynamicgrid:{itemdblclick:function(c,b,g,d,h,f){if(b.data.cs_compound_uri!==undefined){var a=b.data.cs_compound_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];if(parseInt(a)>=1){Ext.create("CS.view.CompoundWindow").showCompound(a)}}},itemcontextmenu:function(d,c,b,e,a,f){a.preventDefault();this.getGridView().showMenu(a.getX(),a.getY(),c)}},"dynamicgrid toolbar #sdfDownloadProxy_id":{click:this.prepSDFile}})},onLaunch:function(){},testThis:function(a){},addCompletedFilter:function(a){console.log("DynamicGrid: addCompletedFilter()");activity_value=this.getFilterContainer().down("#activity_combobox_id").getValue();conditions_value=this.getFilterContainer().down("#conditions_combobox_id").getValue();value_value=this.getFilterContainer().down("#value_textfield_id").getValue();if(activity_value!=null&&conditions_value!=null&&value_value!=""){filter=Ext.create("LSP.model.Filter",{activity:activity_value,condition:conditions_value,value:value_value});this.filters.push(filter);filter.controller=this;filter_view=Ext.create("LSP.view.filter.CompletedFilter",{});filter_view.down("#activityLabel_id").setText(activity_value);filter_view.down("#conditionsLabel_id").setText(conditions_value);filter_view.down("#valueLabel_id").setText(value_value);filter.filterView=filter_view;this.getFormView().down("#completedFilterContainer_id").add(filter_view);this.getFormView().down("#completedFilterContainer_id").setVisible(true);filter_view.filterModel=filter;filter_view.on({close:this.filterClosed});this.setActivityFilters(activity_value,conditions_value,value_value);this.getFormView().down("#addCompletedFilter_id").setDisabled(true)}else{Ext.MessageBox.show({title:"Error",msg:"Filter options cannot be empty.<br>Please select a value for each of the filter options.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}},setActivityFilters:function(c,b,d){console.log("DynamicGrid: setActivityFilters()");var e=this.getGridView();var a=e.store;a.setActivityType(c);a.setActivityValue(d);a.setActivityCondition(b)},filterClosed:function(b){console.log("DynamicGrid: filterClosed()");controller=b.filterModel.controller;var a=controller.filters.indexOf(b.filterModel);controller.filters.splice(a,1);controller.getFormView().down("#addCompletedFilter_id").setDisabled(false)},addFilterForm:function(a){console.log("DynamicGrid: addFilterForm()");hide=this.getFilterContainer().hidden;if(hide){this.getFilterContainer().setVisible(true)}else{this.getFilterContainer().setVisible(false)}},prepSDFile2:function(b){var a=b.up("dynamicgrid");var e=a.store;var c=e.data.items;var f=Ext.create("CS.store.Compound");var d=c.length;var h=0;var g=0;b.setText("SD-file preparing...");Ext.each(c,function(k){var j=k.data.cs_compound_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];if(!isNaN(parseInt(j))){if(k.molfile===undefined||k.molfile.length<30){f.load({params:{"csids[0]":j},callback:function(m,l,n){if(n){h++;compound=f.first().raw.Mol;k.molfile=compound;b.setText("SD-File "+(100*h/d).toFixed(0)+"% ready");if(h===d){b.setText("SD-File ready! Click ->");a.down("#sdfDownload_id").enable()}}else{g++}}},this)}else{h++;b.setText("SD-File "+(100*h/d).toFixed(0)+"% ready")}}else{g++}})},prepSDFile:function(g){var j=g.up("dynamicgrid");var m=j.store;var h=m.data.items;var b=h.length;var e=0;var f=0;g.setText("SD-file preparing...");csid_hash={};csid_molfile_hash={};Ext.each(h,function(o){var n=o.data.cs_compound_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];if(!isNaN(parseInt(n))){if(o.molfile!==undefined&&o.molfile.length>30){csid_molfile_hash[n]=o.molfile}if(csid_hash[n]===undefined){csid_hash[n]=[o.index]}else{csid_hash[n].push(o.index)}}});for(var d in csid_hash){var a=csid_hash[d];var c=(csid_molfile_hash[d]!==undefined);if(c){var k=a.length;for(i=0;i<k;i++){var l=m.getAt(a[i]);if(l.molfile==undefined){l.molfile=csid_molfile_hash[d]}}this.updateSDFStatus(g,m)}else{this.getMolfile(d,a,m,g)}}},updateSDFStatus:function(d,b){var a=b.data.items;var c=a.length;var e=0;var f=0;Ext.each(a,function(g){if(g.molfile===undefined){e++}});f=c-e;d.setText("SD-File "+(100*f/c).toFixed(0)+"% ready");if(f===c){d.setText("SD-File ready! Click ->");d.up("grid").down("#sdfDownload_id").enable()}},getMolfile:function(b,c,d,a){var f=this;var g=Ext.create("CS.store.Compound");var e=c.length;g.load({params:{"csids[0]":b},callback:function(k,h,m){if(m){var j=g.first().raw.Mol;for(i=0;i<e;i++){var l=d.getAt(c[i]);l.molfile=j}f.updateSDFStatus(a,d)}else{}}},this)},prepGrid:function(){console.log(this.$className+": prepGrid()");var b=this.getGridView();var a=b.getStore();a.on("prefetch",this.storeLoadComplete,this)},storeLoadComplete:function(b,a,c){console.log(this.$className+": storeLoadComplete()");grid_view=this.getGridView();grid_store=grid_view.getStore();if(c){grid_view.down("#sdfDownload_id").disable();grid_view.down("#sdfDownloadProxy_id").setText("Prepare SD-file download");grid_view.down("#sdfDownloadProxy_id").enable();this.getSubmitButton().enable();grid_view.setLoading(false);grid_view.setTitle(grid_view.gridBaseTitle+" - Total Records: "+grid_store.getTotalCount())}else{console.log(this.$className+": possible timeout for with uri "+grid_store.proxy.uri);Ext.MessageBox.show({title:"Info",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}},fetchTotalResults:function(){console.log("DynamicGrid: fetchTotalResults() for "+this.$className);try{var e=this.getGridView();var c=e.getStore();var d=this.getFormView();var b=this.getSubmitButton();countStore=this.getCountStore();countStore.uri=c.proxy.reader.uri;if(this.filters.length>0){countStore.setActivityType(this.filters[0].data.activity);countStore.setActivityValue(this.filters[0].data.value);countStore.setActivityCondition(this.filters[0].data.condition)}countStore.load(function(g,f,h){if(h){total=f.response.result.primaryTopic[this.countNode];c.proxy.reader.total_count=total;if(total==0){e.setTitle(e.gridBaseTitle+" - No records found within OPS for this search!");e.down("#sdfDownload_id").disable();e.down("#sdfDownloadProxy_id").setText("Prepare SD-file download");e.down("#sdfDownloadProxy_id").disable();b.enable();e.setLoading(false);Ext.MessageBox.show({title:"Info",msg:"The OPS system does not contain any data that match this search.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}else{c.guaranteeRange(0,49)}}else{e.setTitle(e.gridBaseTitle+" - We are sorry but the OPS system returned an error!");e.down("#sdfDownload_id").disable();e.down("#sdfDownloadProxy_id").setText("Prepare SD-file download");e.down("#sdfDownloadProxy_id").disable();b.enable();e.setLoading(false);Ext.MessageBox.show({title:"Info",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}})}catch(a){console.log("DynamicGrid: exception fetching results for "+this.$className+"with uri "+c.proxy.uri);Ext.MessageBox.show({title:"Info",msg:"We are sorry but the OPS system returned an error.",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}},enableSubmit:function(a){this.getSubmitButton().enable()}});Ext.define("LSP.view.larkc_sim_search.SimSearchScrollingGrid",{extend:"LSP.view.dynamicgrid.DynamicGrid",alias:"widget.SimSearchScrollingGrid",layout:"fit",verticalScrollerType:Ext.create("LDA.helper.DynamicPagingToolbar",{itemId:"pager_id"}),disableSelection:true,invalidateScrollerOnRefresh:false,requires:[],listeners:{sortchange:function(b,c,d,a){console.log("SimSearchScrollingGrid: sortchange()");this.setLoading(true)}},refs:[],store:Ext.create("LDA.store.SimSearchStore",{}),columns:[{xtype:"rownumberer",width:40},{header:"Structure",dataIndex:"cs_compound_uri",xtype:"templatecolumn",tpl:'<img width="128" height="128" src="http://www.chemspider.com/ImagesHandler.ashx?id={csid}&w=128&h=128" alt="CSID:{csid}"/>',sortable:false},{header:"Smiles",dataIndex:"compound_smiles"},{header:"Std Value",dataIndex:"activity_standard_value"},{header:"Chemspider ID",dataIndex:"cs_compound_uri",sortable:false},{header:"Inchi key",dataIndex:"compound_inchikey"},{header:"Std Type",dataIndex:"activity_activity_type"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Std Unit",dataIndex:"activity_standard_units"},{header:"Target Name",dataIndex:"target_title"},{header:"Relation",dataIndex:"activity_relation"},{header:"Molweight",dataIndex:"compound_full_mwt"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Compound name",dataIndex:"compound_pref_label"}]});Ext.define("LSP.controller.SimSearchForm",{extend:"Ext.app.Controller",views:["larkc_sim_search.SimSearchForm","mol_editor_forms.KetcherForm","dataview.StructureViewer","larkc_sim_search.SimSearchScrollingGrid"],refs:[{ref:"ssform",selector:"SimSearchForm"},{ref:"strucGrid",selector:"#simSearchGrid"},{ref:"submitButton",selector:"SimSearchForm #sim_sss_start_search_button_id"}],init:function(){console.log("LSP.controller.SimSearchForm: init()");this.control({"SimSearchForm button[action=ketcher_editor]":{click:this.launchKetcher},"KetcherForm button[action=commit_structure]":{click:this.getSmiles},"SimSearchForm button[action=query]":{click:this.submitQuery},SimSearchForm:{historyToken:this.handleHistoryToken,afterrender:this.prepGrid}})},prepGrid:function(){console.log("LSP.controller.SimSearchForm: prepGrid()");var b=this.getStrucGrid();var a=b.getStore();a.on("prefetch",this.storeLoadComplete,this)},storeLoadComplete:function(b,a,c){console.log("PharmByTargetNameForm: storeLoadComplete()");this.getSubmitButton().enable();this.getSsform().doLayout();this.getSsform().setLoading(false);this.callParent()},hitCoreAPI:function(b){console.log("hitCoreAPI");console.log(b);var a=this.getStrucGrid();a.store.proxy.extraParams={csids:b.join(",")};a.store.load({params:{offset:0,limit:100}})},handleHistoryToken:function(d){console.log("SimSearchForm: handleHistoryToken()");console.log(d);var e=this;var c=Ext.create("CS.engine.search.Structure",{listeners:{finished:function(h,j){c.loadCSIDs(function(k){e.hitCoreAPI(k)})}}});var a="";var f="";var g={};var b=this.getSsform().getValues();g["searchOptions.Molecule"]=b.smiles;if(b.search_type=="1"){a="Exact structure match";f="exact"}else{if(b.search_type=="2"){a="Substructure structure";f="substructure"}else{if(b.search_type=="3"){a="Similarity search";f="similarity";g["searchOptions.Threshold"]=0.99;g["searchOptions.SimilarityType"]="Tanimoto"}else{}}}this.getStrucGrid().setTitle(a);this.getSsform().setLoading(true);c.doSearch(f,g)},launchKetcher:function(c){var a=Ext.widget("KetcherForm");fields=this.getSsform().form.getFields().items;var b="";fields.forEach(function(e){if(e.name=="molfile"){b=e.getValue();var d=12}});if(b!=""){document.getElementById("ketcher_box_id").contentWindow.ketcher.setMolecule(b)}},getSmiles:function(b){var a=document.getElementById("ketcher_box_id");smiles=a.contentWindow.ketcher.getSmiles();molfile=a.contentWindow.ketcher.getMolfile();fields=this.getSsform().form.getFields().items;fields.forEach(function(c){if(c.name=="smiles"){c.setValue(smiles)}else{if(c.name=="molfile"){c.setValue(molfile)}}});b.up("KetcherForm").close()},submitQuery:function(d){console.log("submitQuery");d.disable();var f=d.up("form");var c=this.getStrucGrid();var e=c.store.getRange();c.store.remove(e);this.getStrucGrid().recordsLoaded=0;var a=f.getValues();if(a.smiles.length<4){d.enable();return}var b="exact";if(a.search_type==2){b="sub"}else{if(a.search_type==3){b="sim"}}Ext.History.add("!p=SimSearchForm&sm="+a.smiles+"&st="+b)}});Ext.define("LSP.view.pharm_by_target_name2.PharmByTargetNameForm",{extend:"Ext.form.Panel",alias:"widget.PharmByTargetNameForm",closable:true,requires:["LSP.view.dynamicgrid.DynamicGrid"],layout:{type:"vbox",align:"stretch"},verticalScrollerType:"paginggridscroller",invalidateScrollerOnRefresh:false,disableSelection:true,initComponent:function(){console.log("PharmByTargetNameForm: constructor()");this.items=[{xtype:"label",html:'<span style="font-family: verdana; color: grey; ">Hint: Type in protein name and species. E.g. "ADA protein human"</span>',labelWidth:400,padding:"5 0 0 140"},{xtype:"container",margin:"0 5 5 5",name:"form_fields",layout:{type:"column"},style:"background-color: #fff;",items:[Ext.create("CW.view.ConceptWikiLookup",{xtype:"conceptWikiLookup",fieldLabel:"Protein name",itemId:"pharmByProteinCWLookup",name:"protein_uri",cwTagUuid:"eeaec894-d856-4106-9fa1-662b1dc6c6f1"}),{xtype:"button",itemId:"pharmByTargetSubmit_id",padding:"5 5 5 5",text:"Search...",disabled:true,name:"query_summit_button",action:"query_pharm_by_target_name"}]},{xtype:"container",margin:"0 5 5 5",name:"filter_fields",layout:{type:"column"},style:"background-color: #fff;",items:[{xtype:"button",itemId:"addFilterButton_id",iconCls:"icon-new",padding:"5 5 5 5",tooltip:"Show or hide filter selector",action:"add_filter_form"},{xtype:"label",forId:"addFilterButton_id",text:"Filter",margin:"5 5 5 5"}]},{xtype:"FilterPanel",itemId:"filterContainer_id",margin:"0 5 5 5",name:"filter_fields",hidden:true},{xtype:"container",itemId:"completedFilterContainer_id",margin:"0 5 5 5",name:"completed_filter_container",hidden:true},{xtype:"PharmByTargetNameScrollingGrid",itemId:"pharmByTargetNameGrid",title:"Pharmacology by Target name search results",gridBaseTitle:"Pharmacology by Target name search results",flex:1}];this.callParent(arguments)}});Ext.define("LSP.view.pharm_by_target_name2.PharmByTargetNameScrollingGrid",{extend:"LSP.view.dynamicgrid.DynamicGrid",alias:"widget.PharmByTargetNameScrollingGrid",layout:"fit",verticalScrollerType:Ext.create("LDA.helper.DynamicPagingToolbar",{itemId:"pager_id"}),disableSelection:true,invalidateScrollerOnRefresh:false,requires:[],listeners:{sortchange:function(b,c,d,a){console.log("PharmByTargetNameGrid: sortchange()");this.setLoading(true)}},store:"TargetPharmacologyPaginatedStore",columns:[{xtype:"rownumberer",width:40},{header:"Structure",dataIndex:"cs_compound_uri",xtype:"templatecolumn",tpl:'<img width="128" height="128" src="http://www.chemspider.com/ImagesHandler.ashx?id={csid}&w=128&h=128" alt="CSID:{csid}"/>',sortable:false},{header:"Smiles",dataIndex:"compound_smiles"},{header:"Std Value",dataIndex:"activity_standard_value"},{header:"Chemspider ID",dataIndex:"cs_compound_uri",sortable:false},{header:"Inchi key",dataIndex:"compound_inchikey"},{header:"Std Type",dataIndex:"activity_activity_type"},{header:"Std Unit",dataIndex:"activity_standard_units"},{header:"Target Name",dataIndex:"target_pref_label"},{header:"Relation",dataIndex:"activity_relation"},{header:"Molweight",dataIndex:"compound_full_mwt"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Compound name",dataIndex:"compound_pref_label"},{header:"Compound cw",dataIndex:"cw_compound_uri"}]});Ext.define("LSP.view.pharm_by_cmpd_name2.PharmByCmpdNameScrollingGrid",{extend:"LSP.view.dynamicgrid.DynamicGrid",alias:"widget.PharmByCmpdNameScrollingGrid",layout:"fit",verticalScrollerType:Ext.create("LDA.helper.DynamicPagingToolbar",{itemId:"pager_id"}),disableSelection:true,invalidateScrollerOnRefresh:false,requires:[],listeners:{sortchange:function(b,c,d,a){console.log("PharmByCmpdNameScrollingGrid: sortchange()");this.setLoading(true)}},refs:[],store:"CompoundPharmacologyPaginatedStore",columns:[{xtype:"rownumberer",width:40},{header:"Structure",dataIndex:"cs_compound_uri",xtype:"templatecolumn",tpl:'<img width="128" height="128" src="http://www.chemspider.com/ImagesHandler.ashx?id={csid}&w=128&h=128" alt="CSID:{csid}"/>',sortable:false},{header:"Smiles",dataIndex:"compound_smiles"},{header:"Std Value",dataIndex:"activity_standard_value"},{header:"Chemspider ID",dataIndex:"cs_compound_uri",sortable:false},{header:"Inchi key",dataIndex:"compound_inchikey"},{header:"Std Type",dataIndex:"activity_activity_type"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Std Unit",dataIndex:"activity_standard_units"},{header:"Target Name",dataIndex:"target_title"},{header:"Relation",dataIndex:"activity_relation"},{header:"Molweight",dataIndex:"compound_full_mwt"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Compound name",dataIndex:"compound_pref_label"}]});Ext.define("LSP.view.pharm_by_enzyme_family.PharmByEnzymeFamilyScrollingGrid",{extend:"LSP.view.dynamicgrid.DynamicGrid",alias:"widget.PharmByEnzymeFamilyScrollingGrid",layout:"fit",verticalScrollerType:Ext.create("LDA.helper.DynamicPagingToolbar",{itemId:"pager_id"}),disableSelection:true,invalidateScrollerOnRefresh:false,requires:[],listeners:{sortchange:function(b,c,d,a){console.log("PharmByEnzymeFamilyScrollingGrid: sortchange()");this.setLoading(true)}},store:"EnzymeFamilyPaginatedStore",columns:{defaults:{},items:[{xtype:"rownumberer",width:40},{header:"Structure",dataIndex:"cs_compound_uri",xtype:"templatecolumn",tpl:'<img width="128" height="128" src="http://www.chemspider.com/ImagesHandler.ashx?id={csid}&w=128&h=128" alt="CSID:{csid}"/>',sortable:false},{header:"Smiles",dataIndex:"compound_smiles"},{header:"Std Value",dataIndex:"activity_standard_value"},{header:"Chemspider ID",dataIndex:"cs_compound_uri",sortable:false},{header:"Inchi key",dataIndex:"compound_inchikey"},{header:"Std Type",dataIndex:"activity_activity_type"},{header:"Target Organism",dataIndex:"target_organism"},{header:"Assay Organism",dataIndex:"assay_organism"},{header:"Target Name",dataIndex:"target_title"},{header:"Relation",dataIndex:"activity_relation"},{header:"Molweight",dataIndex:"compound_full_mwt"},{header:"Inchi",dataIndex:"compound_inchi"},{header:"Compound name",dataIndex:"compound_pref_label"}]}});Ext.define("LSP.view.dropdowns.conceptWikiCompoundLookup",{extend:"Ext.form.ComboBox",alias:"widget.conceptWikiCompoundLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"concept_label"},{type:"string",name:"concept_url"},{type:"string",name:"define_url"},{type:"string",name:"concept_uuid"},{type:"string",name:"concept_alt_labels"},{type:"string",name:"tag_label"},{type:"string",name:"tag_uuid"},{type:"string",name:"match"}],proxy:{type:"ajax",api:{read:"/concept_wiki_api_calls/compound_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"concept_url",displayField:"concept_label",name:"compound_uri",minChars:4,hideTrigger:true,forceSelection:true,allowBlank:false,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:700,fieldLabel:"Compound name",labelWidth:120,listConfig:{loadingText:"Searching...",emptyText:"No matching compounds found.",getInnerTpl:function(){return'<p><span style="font-family: verdana; color: grey; "><small>Match: {match}</small></span><br/><b>{concept_label}</b> <a href="{define_url}" target="_blank">(definition)</a></p>'}}});var activity_type=Ext.create("Ext.data.Store",{fields:["abbr","name"],data:[{abbr:"Potency",name:"Potency"},{abbr:"IC50",name:"IC50"}]});var condition=Ext.create("Ext.data.Store",{fields:["symbol","name"],data:[{symbol:"=",name:"="},{symbol:">",name:">"},{symbol:"<",name:"<"},{symbol:"<=",name:"<="},{symbol:">=",name:">="}]});var unit=Ext.create("Ext.data.Store",{fields:["unit","name"],data:[{unit:"nM",name:"nM"},{unit:"mM",name:"mM"},{unit:"M",name:"M"}]});Ext.define("LSP.view.filter.FilterForm",{extend:"Ext.container.Container",alias:"widget.FilterPanel",closable:true,layout:{type:"hbox"},refs:[{ref:"activity_combobox",selector:"#activity_combobox_id"},{ref:"conditions_combobox",selector:"#conditions_combobox_id"},{ref:"value_textfield",selector:"#value_textfield_id"}],headerPosition:"right",frame:true,padding:"0 0 5 0",items:[{xtype:"combobox",itemId:"activity_combobox_id",fieldLabel:"Activity Type",store:activity_type,queryMode:"local",displayField:"abbr",valueField:"name",labelWidth:100,labelPad:2,padding:"0 2 0 0"},{xtype:"combobox",itemId:"conditions_combobox_id",fieldLabel:"Conditions",store:condition,queryMode:"local",displayField:"symbol",valueField:"name",labelWidth:70,labelPad:2,padding:"0 2 0 0"},{xtype:"textfield",itemId:"value_textfield_id",name:"value",fieldLabel:"Value",allowBlank:false,labelWidth:50,labelPad:2,padding:"0 2 0 0"},{xtype:"button",itemId:"addCompletedFilter_id",iconCls:"icon-new",padding:"5 5 5 5",tooltip:"Add this filter",action:"add_completed_filter"}]});Ext.define("LSP.view.Enzymetree",{extend:"Ext.tree.Panel",alias:"widget.enzymeTree",requires:["Ext.data.*","Ext.grid.*","Ext.tree.*"],singleExpand:true,multiSelect:false,rootVisible:false,useArrows:true,frame:true,height:550,autoScroll:true,columns:[{xtype:"treecolumn",text:"EC number",sortable:true,dataIndex:"ec_number",width:160},{text:"Enzyme family name",dataIndex:"name",width:290}],initComponent:function(){console.log("EnzymeTree: initComponent()");var a={store:{fields:[{name:"ec_number",type:"string",sortDir:"ASC"},{name:"name",type:"string"}],proxy:{type:"ajax",api:{read:"enzymes.json"},reader:{type:"json",root:"objects",totalProperty:"totalCount"}},sorters:[{property:"ec_number",direction:"ASC"}],sortOnLoad:true}};Ext.apply(this,a);Ext.apply(this.initialConfig,a);this.callParent(arguments)}});Ext.define("LSP.controller.PharmByTargetNameForm",{extend:"LSP.controller.grids.DynamicGrid",views:["pharm_by_target_name2.PharmByTargetNameForm","pharm_by_target_name2.PharmByTargetNameScrollingGrid"],refs:[{ref:"gridView",selector:"#pharmByTargetNameGrid"},{ref:"formView",selector:"PharmByTargetNameForm"},{ref:"submitButton",selector:"#pharmByTargetSubmit_id"},{ref:"filterContainer",selector:"PharmByTargetNameForm #filterContainer_id"}],init:function(){console.log("PharmByTargetNameForm: init()");this.control({"PharmByTargetNameForm button[action=query_pharm_by_target_name]":{click:this.submitQuery},"PharmByTargetNameForm conceptWikiLookup":{select:this.enableSubmit},PharmByTargetNameForm:{afterrender:this.prepGrid,historyToken:this.handleHistoryToken},"PharmByTargetNameForm button[action=add_filter_form]":{click:this.addFilterForm},"PharmByTargetNameForm button[action=add_completed_filter]":{click:this.addCompletedFilter}})},handleHistoryToken:function(b){if(b.u){var d=this.getGridView();var a=d.store;if(b.u!=a.proxy.extraParams.uri){a.proxy.extraParams.uri=b.u;a.proxy.reader.uri=b.u;d.setLoading(true);this.fetchTotalResults()}}else{if(b.s){var c=this.getLookup();c.setRawValue(b.s);c.doQuery(b.s)}}},getCountStore:function(){return Ext.create("LDA.store.TargetPharmacologyCountStore")},submitQuery:function(b){var c=b.up("form");b.disable();var a=c.getValues();Ext.History.add("!p=PharmByTargetNameForm&u="+a.protein_uri)}});Ext.define("LSP.view.pharm_by_cmpd_name2.PharmByCmpdNameForm",{extend:"Ext.form.Panel",alias:"widget.PharmByCmpdNameForm",closable:true,requires:["LSP.view.dropdowns.conceptWikiCompoundLookup","LDA.helper.DynamicPagingToolbar","LSP.view.filter.FilterForm"],layout:{type:"vbox",align:"stretch"},invalidateScrollerOnRefresh:false,disableSelection:true,initComponent:function(){console.log("PharmByCmpdNameForm: initComponent()");this.items=[{xtype:"label",html:'<span style="font-family: verdana; color: grey; ">Hint: Type in compound name. E.g. "Aspirin"</span>',labelWidth:400,padding:"5 0 0 140"},{xtype:"container",margin:"0 5 5 5",name:"form_fields",layout:{type:"column"},style:"background-color: #fff;",items:[{name:"cmpd_uuid",xtype:"hidden",value:""},Ext.create("CW.view.ConceptWikiLookup",{xtype:"conceptWikiLookup",fieldLabel:"Compound name",itemId:"compoundByNameLookup",name:"compound_uri",cwTagUuid:"07a84994-e464-4bbf-812a-a4b96fa3d197"}),{xtype:"button",itemId:"pharmByCmpdSubmit_id",padding:"5 5 5 5",text:"Search...",disabled:true,action:"query_pharm_by_cmpd_name"}]},{xtype:"container",margin:"0 5 5 5",name:"filter_fields",layout:{type:"column"},style:"background-color: #fff;",items:[{xtype:"button",itemId:"addFilterButton_id",iconCls:"icon-new",padding:"5 5 5 5",tooltip:"Show or hide filter selector",action:"add_filter_form"},{xtype:"label",forId:"addFilterButton_id",text:"Filter",margin:"5 5 5 5"}]},{xtype:"FilterPanel",itemId:"filterContainer_id",margin:"0 5 5 5",name:"filter_fields",hidden:true},{xtype:"container",itemId:"completedFilterContainer_id",margin:"0 5 5 5",name:"completed_filter_container",hidden:true},{xtype:"PharmByCmpdNameScrollingGrid",itemId:"pharmByCmpdNameGrid",title:"Pharmacology by Compound name search results",gridBaseTitle:"Pharmacology by Compound name search results",flex:1}];this.callParent(arguments)}});Ext.define("LSP.model.Filter",{extend:"Ext.data.Model",fields:["activity","condition","value","unit","filterView","controller"],});Ext.define("LSP.controller.PharmByCmpdNameForm",{extend:"LSP.controller.grids.DynamicGrid",views:["pharm_by_cmpd_name2.PharmByCmpdNameForm","pharm_by_cmpd_name2.PharmByCmpdNameScrollingGrid"],refs:[{ref:"gridView",selector:"#pharmByCmpdNameGrid"},{ref:"formView",selector:"PharmByCmpdNameForm"},{ref:"submitButton",selector:"#pharmByCmpdSubmit_id"},{ref:"nextRecordsButton",selector:"PharmByCmpdNameForm dynamicgrid3 #nextRecords"},{ref:"lookup",selector:"#pharmByCmpdLookup"},{ref:"filterContainer",selector:"PharmByCmpdNameForm #filterContainer_id"}],init:function(){console.log("PharmByCmpdNameForm: init()");this.control({"PharmByCmpdNameForm button[action=query_pharm_by_cmpd_name]":{click:this.submitQuery},"PharmByCmpdNameForm conceptWikiLookup":{select:this.enableSubmit},PharmByCmpdNameForm:{historyToken:this.handleHistoryToken,afterrender:this.prepGrid},"PharmByCmpdNameForm button[action=add_filter_form]":{click:this.addFilterForm},"PharmByCmpdNameForm button[action=add_completed_filter]":{click:this.addCompletedFilter}})},handleHistoryToken:function(b){console.log("PharmByCmpdNameForm: handleHistoryToken()");if(b.u){var d=this.getGridView();var a=d.store;if(b.u!=a.proxy.extraParams.uri){a.proxy.extraParams.uri=b.u;a.proxy.reader.uri=b.u;d.setLoading(true);this.fetchTotalResults()}}else{if(b.s){var c=this.getLookup();c.setRawValue(b.s);c.doQuery(b.s)}}},getCountStore:function(){return Ext.create("LDA.store.CompoundPharmacologyCountStore")},submitQuery:function(b){console.log("PharmByCmpdNameForm: submitQuery()");var c=b.up("form");b.disable();var a=c.getValues();Ext.History.add("!p=PharmByCmpdNameForm&u="+a.compound_uri)}});Ext.define("LSP.view.tree_selector_forms.EnzymeTreeForm",{extend:"Ext.window.Window",alias:"widget.EnzymeTreeForm",requires:["Ext.form.Panel","LSP.view.Enzymetree"],title:"Select an enzyme family",layout:"fit",modal:true,autoShow:true,height:600,width:500,items:[{xtype:"form",padding:"0 0 0 0",border:false,style:"background-color: #fff;",items:[{xtype:"enzymeTree"}]}],buttons:[{text:"Use selection",action:"get_enzyme"},{text:"Cancel",action:"hide_enzyme_form"}],initComponent:function(){console.log("EnzymeTreeForm: initComponent()");this.callParent(arguments)}});Ext.define("LSP.view.pharm_by_enzyme_family.PharmEnzymeForm",{extend:"Ext.form.Panel",alias:"widget.PharmEnzymeForm",closable:true,requires:["LSP.view.tree_selector_forms.EnzymeTreeForm","LSP.view.dynamicgrid.DynamicGrid"],layout:{type:"vbox",align:"stretch"},initComponent:function(){console.log("PharmEnzymeForm: initComponent()");this.items=[{xtype:"container",height:34,name:"form_fields",layout:{type:"column"},items:[{xtype:"displayfield",name:"enzyme_family",margin:"5 5 5 5",width:688,value:"No enzyme class selected - press button ->",fieldLabel:"Enzyme family class",labelWidth:130},{xtype:"button",padding:"5 5 5 5",text:"Browse EC codes",action:"enz_tree"},{name:"enz_name",xtype:"hidden",value:""},{name:"ec_number",xtype:"hidden",value:""}]},{xtype:"button",action:"query",itemId:"submitEnzymePharm_id",text:"Start search..."},{xtype:"container",margin:"0 5 5 5",name:"filter_fields",layout:{type:"column"},style:"background-color: #fff;",items:[{xtype:"button",itemId:"addFilterButton_id",iconCls:"icon-new",padding:"5 5 5 5",tooltip:"Show or hide filter selector",action:"add_filter_form"},{xtype:"label",forId:"addFilterButton_id",text:"Filter",margin:"5 5 5 5"}]},{xtype:"FilterPanel",itemId:"filterContainer_id",margin:"0 5 5 5",name:"filter_fields",hidden:true},{xtype:"container",itemId:"completedFilterContainer_id",margin:"0 5 5 5",name:"completed_filter_container",hidden:true},{xtype:"PharmByEnzymeFamilyScrollingGrid",itemId:"pharmByEnzymeFamilyGrid",title:"Pharmacology by Enzyme Family search results",gridBaseTitle:"Pharmacology by Enzyme Family search results",flex:1}];this.callParent(arguments)}});Ext.define("LSP.controller.PharmByEnzymeFamily",{extend:"LSP.controller.grids.DynamicGrid",views:["pharm_by_enzyme_family.PharmEnzymeForm","pharm_by_enzyme_family.PharmByEnzymeFamilyScrollingGrid","tree_selector_forms.EnzymeTreeForm"],refs:[{ref:"gridView",selector:"#pharmByEnzymeFamilyGrid"},{ref:"formView",selector:"PharmEnzymeForm"},{ref:"submitButton",selector:"#submitEnzymePharm_id"},{ref:"filterContainer",selector:"PharmEnzymeForm #filterContainer_id"}],init:function(){console.log("PharmByEnzymeFamily: init()");this.control({"PharmEnzymeForm button[action=enz_tree]":{click:this.launchEnzyme},"EnzymeTreeForm button[action=get_enzyme]":{click:this.getEnzyme},"EnzymeTreeForm button[action=hide_enzyme_form]":{click:this.hideEnzyme},"PharmEnzymeForm #submitEnzymePharm_id":{click:this.submitQuery},PharmEnzymeForm:{afterrender:this.prepGrid,historyToken:this.handleHistoryToken},"PharmEnzymeForm button[action=add_filter_form]":{click:this.addFilterForm},"PharmEnzymeForm button[action=add_completed_filter]":{click:this.addCompletedFilter}})},handleHistoryToken:function(b){console.log("PharmByEnzymeFamily: handleHistoryToken()");if(b.ec){var c=this.getGridView();var a=c.getStore();c.setLoading(true);a.setURI("http://purl.uniprot.org/enzyme/"+b.ec);a.proxy.reader.uri="http://purl.uniprot.org/enzyme/"+b.ec;this.fetchTotalResults()}},getCountStore:function(){return Ext.create("LDA.store.EnzymeFamilyCountStore")},launchEnzyme:function(b){console.log("PharmByEnzymeFamily: launchEnzyme()");var a=Ext.ComponentQuery.query("EnzymeTreeForm")[0];if(a){console.log("enzyme show");a.show()}else{console.log("enzyme create");a=Ext.widget("EnzymeTreeForm");a.show()}},hideEnzyme:function(b){console.log("PharmByEnzymeFamily: hideEnzyme()");var a=Ext.ComponentQuery.query("EnzymeTreeForm")[0];if(a){console.log("enzyme hide");a.hide()}},getEnzyme:function(d){console.log("PharmByEnzymeFamily: getEnzyme()");var b=d.up().up().down("enzymeTree");var e=b.getView().getSelectionModel().getSelection();var f=e[0].data;if(f.leaf){Ext.Msg.show({title:"Incorrect selection",msg:"Please select an enzyme class (folder).",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}else{var a=this.getFormView().getForm().findField("enzyme_family");a.setValue("<b>"+f.ec_number+" : "+f.name+"</b>");var c=this.getFormView().getForm().findField("ec_number");c.setValue(f.ec_number);var g=this.getFormView().getForm().findField("enz_name");g.setValue(f.name);this.hideEnzyme("")}},submitQuery:function(b){console.log("PharmByEnzymeFamily: submitQuery()");var c=b.up("form");b.disable();var a=c.getValues();Ext.History.add("!p=PharmEnzymeForm&ec="+a.ec_number)}});(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b(e){e=e.replace(/\r\n/g,"\n");var d="";for(var g=0;g<e.length;g++){var f=e.charCodeAt(g);if(f<128){d+=String.fromCharCode(f)}else{if((f>127)&&(f<2048)){d+=String.fromCharCode((f>>6)|192);d+=String.fromCharCode((f&63)|128)}else{d+=String.fromCharCode((f>>12)|224);d+=String.fromCharCode(((f>>6)&63)|128);d+=String.fromCharCode((f&63)|128)}}}return d}Ext.define("Ext.ux.exporter.Base64",{statics:{encode:function(e){var c="";var m,k,h,l,j,g,f;var d=0;e=b(e);while(d<e.length){m=e.charCodeAt(d++);k=e.charCodeAt(d++);h=e.charCodeAt(d++);l=m>>2;j=((m&3)<<4)|(k>>4);g=((k&15)<<2)|(h>>6);f=h&63;if(isNaN(k)){g=f=64}else{if(isNaN(h)){f=64}}c=c+a.charAt(l)+a.charAt(j)+a.charAt(g)+a.charAt(f)}return c}}})})();Ext.define("Ext.ux.exporter.Button",{extend:"Ext.Component",alias:"widget.exporterbutton",html:"<p></p>",config:{swfPath:"/flash/downloadify.swf",downloadImage:"/images/ext_reports/download.png",width:62,height:22,downloadName:"download"},constructor:function(b){b=b||{};this.initConfig();Ext.ux.exporter.Button.superclass.constructor.call(this,b);var a=this;this.on("afterrender",function(){a.setComponent(a.store||a.component||a.up("gridpanel")||a.up("treepanel"),b)})},setComponent:function(b,a){this.component=b;this.store=!b.is?b:b.getStore();this.setDownloadify(a)},setDownloadify:function(b){var a=this;Downloadify.create(this.el.down("p").id,{filename:function(){return a.getDownloadName()+"."+Ext.ux.exporter.Exporter.getFormatterByName(a.formatter).extension},data:function(){return Ext.ux.exporter.Exporter.exportAny(a.component,a.formatter,b)},onComplete:function(){alert("Your File Has Been Saved!")},onCancel:function(){alert("You have cancelled the saving of this file.")},onError:function(){alert("You must put something in the File Contents or there will be nothing to save!")},transparent:false,swf:this.getSwfPath(),downloadImage:this.getDownloadImage(),width:this.getWidth(),height:this.getHeight(),transparent:true,append:true})}});Ext.define("Ext.ux.grid.menu.ListMenu",{extend:"Ext.menu.Menu",labelField:"text",loadingText:"Loading...",loadOnShow:true,single:false,constructor:function(b){var e=this,c,d,a,f;e.selected=[];e.addEvents("checkchange");e.callParent([b=b||{}]);if(!b.store&&b.options){c=[];for(d=0,a=b.options.length;d<a;d++){f=b.options[d];switch(Ext.type(f)){case"array":c.push(f);break;case"object":c.push([f.id,f[e.labelField]]);break;case"string":c.push([f,f]);break}}e.store=Ext.create("Ext.data.ArrayStore",{fields:["id",e.labelField],data:c,listeners:{load:e.onLoad,scope:e}});e.loaded=true;e.autoStore=true}else{e.add({text:e.loadingText,iconCls:"loading-indicator"});e.store.on("load",e.onLoad,e)}},destroy:function(){var b=this,a=b.store;if(a){if(b.autoStore){a.destroyStore()}else{a.un("unload",b.onLoad,b)}}b.callParent()},show:function(){if(this.loadOnShow&&!this.loaded&&!this.store.loading){this.store.load()}this.callParent()},onLoad:function(c,b){var g=this,f,h,d,a,e={checkchange:g.checkChange,scope:g};Ext.suspendLayouts();g.removeAll(true);f=g.single?Ext.id():null;for(d=0,a=b.length;d<a;d++){h=b[d].get("id");g.add(Ext.create("Ext.menu.CheckItem",{text:b[d].get(g.labelField),group:f,checked:Ext.Array.contains(g.selected,h),hideOnClick:false,value:h,listeners:e}))}g.loaded=true;Ext.resumeLayouts(true);g.fireEvent("load",g,b)},getSelected:function(){return this.selected},setSelected:function(a){a=this.selected=[].concat(a);if(this.loaded){this.items.each(function(d){d.setChecked(false,true);for(var c=0,b=a.length;c<b;c++){if(d.value==a[c]){d.setChecked(true,true)}}},this)}},checkChange:function(b,a){var c=[];this.items.each(function(d){if(d.checked){c.push(d.value)}},this);this.selected=c;this.fireEvent("checkchange",b,a)}});Ext.define("Ext.ux.grid.menu.RangeMenu",{extend:"Ext.menu.Menu",fieldCls:"Ext.form.field.Number",iconCls:{gt:"ux-rangemenu-gt",lt:"ux-rangemenu-lt",eq:"ux-rangemenu-eq"},fieldLabels:{gt:"Greater Than",lt:"Less Than",eq:"Equal To"},menuItemCfgs:{emptyText:"Enter Number...",selectOnFocus:false,width:155},menuItems:["lt","gt","-","eq"],constructor:function(a){var f=this,c,g,b,e,h,d,j;f.callParent(arguments);c=f.fields=f.fields||{};g=f.fieldCfg=f.fieldCfg||{};f.addEvents("update");f.updateTask=Ext.create("Ext.util.DelayedTask",f.fireUpdate,f);for(b=0,e=f.menuItems.length;b<e;b++){h=f.menuItems[b];if(h!=="-"){d={itemId:"range-"+h,enableKeyEvents:true,hideLabel:false,fieldLabel:f.iconTpl.apply({cls:f.iconCls[h]||"no-icon",text:f.fieldLabels[h]||"",src:Ext.BLANK_IMAGE_URL}),labelSeparator:"",labelWidth:29,labelStyle:"position: relative;",listeners:{scope:f,change:f.onInputChange,keyup:f.onInputKeyUp,el:{click:function(k){k.stopPropagation()}}},activate:Ext.emptyFn,deactivate:Ext.emptyFn};Ext.apply(d,Ext.applyIf(c[h]||{},g[h]),f.menuItemCfgs);j=d.fieldCls||f.fieldCls;h=c[h]=Ext.create(j,d)}f.add(h)}},fireUpdate:function(){this.fireEvent("update",this)},getValue:function(){var a={},b,c;for(b in this.fields){c=this.fields[b];if(c.isValid()&&c.getValue()!==null){a[b]=c.getValue()}}return a},setValue:function(c){var b=this,a,d;for(a in b.fields){d=b.fields[a];d.suspendEvents();d.setValue(a in c?c[a]:"");d.resumeEvents()}b.fireEvent("update",b)},onInputKeyUp:function(b,a){if(a.getKey()===a.RETURN&&b.isValid()){a.stopEvent();this.hide()}},onInputChange:function(f){var e=this,c=e.fields,b=c.eq,d=c.gt,a=c.lt;if(f==b){if(d){d.setValue(null)}if(a){a.setValue(null)}}else{b.setValue(null)}this.updateTask.delay(this.updateBuffer)}},function(){this.prototype.iconTpl=Ext.create("Ext.XTemplate",'<img src="{src}" alt="{text}" class="'+Ext.baseCSSPrefix+'menu-item-icon ux-rangemenu-icon {cls}" />')});Ext.define("Ext.ux.exporter.Formatter",{format:Ext.emptyFn,constructor:function(a){a=a||{};Ext.applyIf(a,{})}});Ext.define("Ext.ux.grid.filter.Filter",{extend:"Ext.util.Observable",active:false,dataIndex:null,menu:null,updateBuffer:500,constructor:function(a){Ext.apply(this,a);this.addEvents("activate","deactivate","serialize","update");Ext.ux.grid.filter.Filter.superclass.constructor.call(this);this.menu=this.createMenu(a);this.init(a);if(a&&a.value){this.setValue(a.value);this.setActive(a.active!==false,true);delete a.value}},destroy:function(){if(this.menu){this.menu.destroy()}this.clearListeners()},init:Ext.emptyFn,createMenu:function(a){return Ext.create("Ext.menu.Menu",a)},getValue:Ext.emptyFn,setValue:Ext.emptyFn,isActivatable:function(){return true},getSerialArgs:Ext.emptyFn,validateRecord:function(){return true},serialize:function(){var a=this.getSerialArgs();this.fireEvent("serialize",a,this);return a},fireUpdate:function(){if(this.active){this.fireEvent("update",this)}this.setActive(this.isActivatable())},setActive:function(b,a){if(this.active!=b){this.active=b;if(a!==true){this.fireEvent(b?"activate":"deactivate",this)}}}});Ext.define("Ext.ux.exporter.csvFormatter.CsvFormatter",{extend:"Ext.ux.exporter.Formatter",contentType:"data:text/csv;base64,",separator:";",extension:"csv",format:function(a,b){this.columns=b.columns||(a.fields?a.fields.items:a.model.prototype.fields.items);return this.getHeaders()+"\n"+this.getRows(a)},getHeaders:function(a){var b=[],c;Ext.each(this.columns,function(d){var e;if(d.text!=undefined){e=d.text}else{if(d.name){e=d.name.replace(/_/g," ");e=Ext.String.capitalize(e)}}if(d.text!="&#160"){b.push(e)}},this);return b.join(this.separator)},getRows:function(a){var b=[];a.each(function(c,d){b.push(this.geCell(c,d))},this);return b.join("\n")},geCell:function(a,c){var b=[];Ext.each(this.columns,function(e){var d=e.name||e.dataIndex;if(d){if(Ext.isFunction(e.renderer)){var f=e.renderer(a.get(d),null,a)}else{var f=a.get(d)}b.push(f)}});return b.join(this.separator)}});Ext.define("Ext.ux.exporter.sdfFormatter.SdfFormatter",{extend:"Ext.ux.exporter.Formatter",contentType:"data:text/plain;base64,",extension:"sdf",format:function(b,c){var d=this;var a=[];b.each(function(e,f){a.push(this.buildRecord(c.columns,e,e.molfile))},this);return a.join("\n")+"\n"},buildRecord:function(c,e,b){var d=[];var a=e.data.cs_compound_uri.match(/http:\/\/rdf.chemspider.com\/(\d+)/)[1];Ext.each(c,function(g){var f=">  <";if(!g.hidden&&g.text!="&#160"){var j=e.data[g.dataIndex];if(j.text!==undefined){j=j.text}var k=this.stripTags(j);var h=this.escapeTextSeperator(k);f=f+this.stripTags(g.text)+"> ("+a+")\n";f=f+h+"\n";if(h!==""){d.push(f)}}},this);return b+d.join("\n")+"\n$$$$"},stripTags:function(b){if(typeof(b)==="string"){b=b.replace(/<(.|\n)*?>/gi,"")}var a=document.createElement("textarea");a.innerHTML=b;return a.value},escapeTextSeperator:function(b){if(typeof(b)==="string"){b=b.replace(/"/gi,'""')}var a=document.createElement("textarea");a.innerHTML=b;return a.value}});Ext.define("Ext.ux.exporter.excelFormatter.ExcelFormatter",{extend:"Ext.ux.exporter.Formatter",uses:["Ext.ux.exporter.excelFormatter.Cell","Ext.ux.exporter.excelFormatter.Style","Ext.ux.exporter.excelFormatter.Worksheet","Ext.ux.exporter.excelFormatter.Workbook"],contentType:"data:application/vnd.ms-excel;base64,",extension:"xls",format:function(b,c){var a=new Ext.ux.exporter.excelFormatter.Workbook(c);a.addWorksheet(b,c||{});return a.render()}});Ext.define("Ext.ux.grid.filter.BooleanFilter",{extend:"Ext.ux.grid.filter.Filter",alias:"gridfilter.boolean",defaultValue:false,yesText:"Yes",noText:"No",init:function(a){var c=Ext.id();this.options=[Ext.create("Ext.menu.CheckItem",{text:this.yesText,group:c,checked:this.defaultValue===true}),Ext.create("Ext.menu.CheckItem",{text:this.noText,group:c,checked:this.defaultValue===false})];this.menu.add(this.options[0],this.options[1]);for(var b=0;b<this.options.length;b++){this.options[b].on("click",this.fireUpdate,this);this.options[b].on("checkchange",this.fireUpdate,this)}},getValue:function(){return this.options[0].checked},setValue:function(a){this.options[a?0:1].setChecked(true)},getSerialArgs:function(){var a={type:"boolean",value:this.getValue()};return a},validateRecord:function(a){return a.get(this.dataIndex)==this.getValue()}});Ext.define("Ext.ux.grid.filter.NumericFilter",{extend:"Ext.ux.grid.filter.Filter",alias:"gridfilter.numeric",uses:["Ext.form.field.Number"],createMenu:function(a){var b=this,c;c=Ext.create("Ext.ux.grid.menu.RangeMenu",a);c.on("update",b.fireUpdate,b);return c},getValue:function(){return this.menu.getValue()},setValue:function(a){this.menu.setValue(a)},isActivatable:function(){var a=this.getValue(),b;for(b in a){if(a[b]!==undefined){return true}}return false},getSerialArgs:function(){var c,b=[],a=this.menu.getValue();for(c in a){b.push({type:"numeric",comparison:c,value:a[c]})}return b},validateRecord:function(a){var d=a.get(this.dataIndex),b=this.getValue(),c=Ext.isNumber;if(c(b.eq)&&d!=b.eq){return false}if(c(b.lt)&&d>=b.lt){return false}if(c(b.gt)&&d<=b.gt){return false}return true}});Ext.define("Ext.ux.grid.filter.StringFilter",{extend:"Ext.ux.grid.filter.Filter",alias:"gridfilter.string",iconCls:"ux-gridfilter-text-icon",emptyText:"Enter Filter Text...",selectOnFocus:true,width:125,init:function(a){Ext.applyIf(a,{enableKeyEvents:true,iconCls:this.iconCls,hideLabel:true,listeners:{scope:this,keyup:this.onInputKeyUp,el:{click:function(b){b.stopPropagation()}}}});this.inputItem=Ext.create("Ext.form.field.Text",a);this.menu.add(this.inputItem);this.updateTask=Ext.create("Ext.util.DelayedTask",this.fireUpdate,this)},getValue:function(){return this.inputItem.getValue()},setValue:function(a){this.inputItem.setValue(a);this.fireEvent("update",this)},isActivatable:function(){return this.inputItem.getValue().length>0},getSerialArgs:function(){return{type:"string",value:this.getValue()}},validateRecord:function(a){var b=a.get(this.dataIndex);if(typeof b!="string"){return(this.getValue().length===0)}return b.toLowerCase().indexOf(this.getValue().toLowerCase())>-1},onInputKeyUp:function(c,b){var a=b.getKey();if(a==b.RETURN&&c.isValid()){b.stopEvent();this.menu.hide();return}this.updateTask.delay(this.updateBuffer)}});Ext.define("Ext.ux.grid.filter.ListFilter",{extend:"Ext.ux.grid.filter.Filter",alias:"gridfilter.list",phpMode:false,init:function(a){this.dt=Ext.create("Ext.util.DelayedTask",this.fireUpdate,this)},createMenu:function(a){var b=Ext.create("Ext.ux.grid.menu.ListMenu",a);b.on("checkchange",this.onCheckChange,this);return b},getValue:function(){return this.menu.getSelected()},setValue:function(a){this.menu.setSelected(a);this.fireEvent("update",this)},isActivatable:function(){return this.getValue().length>0},getSerialArgs:function(){return{type:"list",value:this.phpMode?this.getValue().join(","):this.getValue()}},onCheckChange:function(){this.dt.delay(this.updateBuffer)},validateRecord:function(a){var b=this.getValue();return Ext.Array.indexOf(b,a.get(this.dataIndex))>-1}});Ext.define("Ext.ux.grid.filter.DateFilter",{extend:"Ext.ux.grid.filter.Filter",alias:"gridfilter.date",uses:["Ext.picker.Date","Ext.menu.Menu"],afterText:"After",beforeText:"Before",compareMap:{before:"lt",after:"gt",on:"eq"},dateFormat:"m/d/Y",menuItems:["before","after","-","on"],menuItemCfgs:{selectOnFocus:true,width:125},onText:"On",pickerOpts:{},init:function(d){var g=this,c,e,a,f,b;c=Ext.apply(g.pickerOpts,{xtype:"datepicker",minDate:g.minDate,maxDate:g.maxDate,format:g.dateFormat,listeners:{scope:g,select:g.onMenuSelect}});g.fields={};for(e=0,a=g.menuItems.length;e<a;e++){f=g.menuItems[e];if(f!=="-"){b={itemId:"range-"+f,text:g[f+"Text"],menu:Ext.create("Ext.menu.Menu",{items:[Ext.apply(c,{itemId:f})]}),listeners:{scope:g,checkchange:g.onCheckChange}};f=g.fields[f]=Ext.create("Ext.menu.CheckItem",b)}g.menu.add(f)}},onCheckChange:function(){this.setActive(this.isActivatable());this.fireEvent("update",this)},onInputKeyUp:function(c,b){var a=b.getKey();if(a==b.RETURN&&c.isValid()){b.stopEvent();this.menu.hide()}},onMenuSelect:function(c,b){var a=this.fields,d=this.fields[c.itemId];d.setChecked(true);if(d==a.on){a.before.setChecked(false,true);a.after.setChecked(false,true)}else{a.on.setChecked(false,true);if(d==a.after&&this.getFieldValue("before")<b){a.before.setChecked(false,true)}else{if(d==a.before&&this.getFieldValue("after")>b){a.after.setChecked(false,true)}}}this.fireEvent("update",this);c.up("menu").hide()},getValue:function(){var b,a={};for(b in this.fields){if(this.fields[b].checked){a[b]=this.getFieldValue(b)}}return a},setValue:function(c,b){var a;for(a in this.fields){if(c[a]){this.getPicker(a).setValue(c[a]);this.fields[a].setChecked(true)}else{if(!b){this.fields[a].setChecked(false)}}}this.fireEvent("update",this)},isActivatable:function(){var a;for(a in this.fields){if(this.fields[a].checked){return true}}return false},getSerialArgs:function(){var a=[];for(var b in this.fields){if(this.fields[b].checked){a.push({type:"date",comparison:this.compareMap[b],value:Ext.Date.format(this.getFieldValue(b),this.dateFormat)})}}return a},getFieldValue:function(a){return this.getPicker(a).getValue()},getPicker:function(a){return this.fields[a].menu.items.first()},validateRecord:function(b){var c,e,d=b.get(this.dataIndex),a=Ext.Date.clearTime;if(!Ext.isDate(d)){return false}d=a(d,true).getTime();for(c in this.fields){if(this.fields[c].checked){e=a(this.getFieldValue(c),true).getTime();if(c=="before"&&e<=d){return false}if(c=="after"&&e>=d){return false}if(c=="on"&&e!=d){return false}}}return true}});Ext.define("Ext.ux.exporter.excelFormatter.Cell",{constructor:function(a){Ext.applyIf(a,{type:"String"});Ext.apply(this,a);Ext.ux.exporter.excelFormatter.Cell.superclass.constructor.apply(this,arguments)},render:function(){return this.tpl.apply(this)},tpl:new Ext.XTemplate('<ss:Cell ss:StyleID="{style}">','<ss:Data ss:Type="{type}"><![CDATA[{value}]]></ss:Data>',"</ss:Cell>")});Ext.define("Ext.ux.exporter.excelFormatter.Style",{constructor:function(a){a=a||{};Ext.apply(this,a,{parentStyle:"",attributes:[]});Ext.ux.exporter.excelFormatter.Style.superclass.constructor.apply(this,arguments);if(this.id==undefined){throw new Error("An ID must be provided to Style")}this.preparePropertyStrings()},preparePropertyStrings:function(){Ext.each(this.attributes,function(a,b){this.attributes[b].propertiesString=this.buildPropertyString(a);this.attributes[b].children=a.children||[];Ext.each(a.children,function(d,c){this.attributes[b].children[c].propertiesString=this.buildPropertyString(d)},this)},this)},buildPropertyString:function(b){var a="";Ext.each(b.properties||[],function(c){a+=Ext.String.format('ss:{0}="{1}" ',c.name,c.value)},this);return a},render:function(){return this.tpl.apply(this)},tpl:new Ext.XTemplate('<tpl if="parentStyle.length == 0">','<ss:Style ss:ID="{id}">',"</tpl>",'<tpl if="parentStyle.length != 0">','<ss:Style ss:ID="{id}" ss:Parent="{parentStyle}">',"</tpl>",'<tpl for="attributes">','<tpl if="children.length == 0">',"<ss:{name} {propertiesString} />","</tpl>",'<tpl if="children.length > 0">',"<ss:{name} {propertiesString}>",'<tpl for="children">',"<ss:{name} {propertiesString} />","</tpl>","</ss:{name}>","</tpl>","</tpl>","</ss:Style>")});Ext.define("Ext.ux.exporter.excelFormatter.Worksheet",{constructor:function(a,b){b=b||{};this.store=a;Ext.applyIf(b,{hasTitle:true,hasHeadings:true,stripeRows:true,title:"Workbook",columns:a.fields==undefined?{}:a.fields.items});Ext.apply(this,b);Ext.ux.exporter.excelFormatter.Worksheet.superclass.constructor.apply(this,arguments)},dateFormatString:"Y-m-d",worksheetTpl:new Ext.XTemplate('<ss:Worksheet ss:Name="{title}">',"<ss:Names>",'<ss:NamedRange ss:Name="Print_Titles" ss:RefersTo="=\'{title}\'!R1:R2" />',"</ss:Names>",'<ss:Table x:FullRows="1" x:FullColumns="1" ss:ExpandedColumnCount="{colCount}" ss:ExpandedRowCount="{rowCount}">',"{columns}",'<ss:Row ss:Height="38">','<ss:Cell ss:StyleID="title" ss:MergeAcross="{colCount - 1}">','<ss:Data xmlns:html="http://www.w3.org/TR/REC-html40" ss:Type="String">','<html:B><html:U><html:Font html:Size="15">{title}','</html:Font></html:U></html:B></ss:Data><ss:NamedCell ss:Name="Print_Titles" />',"</ss:Cell>","</ss:Row>",'<ss:Row ss:AutoFitHeight="1">',"{header}","</ss:Row>","{rows}","</ss:Table>","<x:WorksheetOptions>","<x:PageSetup>",'<x:Layout x:CenterHorizontal="1" x:Orientation="Landscape" />','<x:Footer x:Data="Page &amp;P of &amp;N" x:Margin="0.5" />','<x:PageMargins x:Top="0.5" x:Right="0.5" x:Left="0.5" x:Bottom="0.8" />',"</x:PageSetup>","<x:FitToPage />","<x:Print>","<x:PrintErrors>Blank</x:PrintErrors>","<x:FitWidth>1</x:FitWidth>","<x:FitHeight>32767</x:FitHeight>","<x:ValidPrinterInfo />","<x:VerticalResolution>600</x:VerticalResolution>","</x:Print>","<x:Selected />","<x:DoNotDisplayGridlines />","<x:ProtectObjects>False</x:ProtectObjects>","<x:ProtectScenarios>False</x:ProtectScenarios>","</x:WorksheetOptions>","</ss:Worksheet>"),render:function(a){return this.worksheetTpl.apply({header:this.buildHeader(),columns:this.buildColumns().join(""),rows:this.buildRows().join(""),colCount:this.columns.length,rowCount:this.store.getCount()+2,title:this.title})},buildColumns:function(){var a=[];Ext.each(this.columns,function(b){a.push(this.buildColumn())},this);return a},buildColumn:function(a){return Ext.String.format('<ss:Column ss:AutoFitWidth="1" ss:Width="{0}" />',a||164)},buildRows:function(){var a=[];this.store.each(function(b,c){a.push(this.buildRow(b,c))},this);return a},buildHeader:function(){var a=[];Ext.each(this.columns,function(b){var c;if(b.text!=undefined){c=b.text}else{if(b.name){c=b.name.replace(/_/g," ");c=Ext.String.capitalize(c)}}a.push(Ext.String.format('<ss:Cell ss:StyleID="headercell"><ss:Data ss:Type="String">{0}</ss:Data><ss:NamedCell ss:Name="Print_Titles" /></ss:Cell>',c))},this);return a.join("")},buildRow:function(a,c){var d,b=[];if(this.stripeRows===true){d=c%2==0?"even":"odd"}Ext.each(this.columns,function(f){var e=f.name||f.dataIndex;if(e){if(Ext.isFunction(f.renderer)){var h=f.renderer(a.get(e),null,a),g="String"}else{var h=a.get(e),g=this.typeMappings[f.type||a.fields.get(e).type.type]}b.push(this.buildCell(h,g,d).render())}},this);return Ext.String.format("<ss:Row>{0}</ss:Row>",b.join(""))},buildCell:function(c,b,a){if(b=="DateTime"&&Ext.isFunction(c.format)){c=c.format(this.dateFormatString)}return new Ext.ux.exporter.excelFormatter.Cell({value:c,type:b,style:a})},typeMappings:{"int":"Number",string:"String","float":"Number",date:"DateTime"}});Ext.define("Ext.ux.exporter.excelFormatter.Workbook",{constructor:function(a){a=a||{};Ext.apply(this,a,{title:"Workbook",worksheets:[],compiledWorksheets:[],cellBorderColor:"#e4e4e4",styles:[],compiledStyles:[],hasDefaultStyle:true,hasStripeStyles:true,windowHeight:9000,windowWidth:50000,protectStructure:false,protectWindows:false});if(this.hasDefaultStyle){this.addDefaultStyle()}if(this.hasStripeStyles){this.addStripedStyles()}this.addTitleStyle();this.addHeaderStyle()},render:function(){this.compileStyles();this.joinedCompiledStyles=this.compiledStyles.join("");this.compileWorksheets();this.joinedWorksheets=this.compiledWorksheets.join("");return this.tpl.apply(this)},addWorksheet:function(a,b){var c=new Ext.ux.exporter.excelFormatter.Worksheet(a,b);this.worksheets.push(c);return c},addStyle:function(a){var b=new Ext.ux.exporter.excelFormatter.Style(a||{});this.styles.push(b);return b},compileStyles:function(){this.compiledStyles=[];Ext.each(this.styles,function(a){this.compiledStyles.push(a.render())},this);return this.compiledStyles},compileWorksheets:function(){this.compiledWorksheets=[];Ext.each(this.worksheets,function(a){this.compiledWorksheets.push(a.render())},this);return this.compiledWorksheets},tpl:new Ext.XTemplate('<?xml version="1.0" encoding="utf-8"?>','<ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:o="urn:schemas-microsoft-com:office:office">',"<o:DocumentProperties>","<o:Title>{title}</o:Title>","</o:DocumentProperties>","<ss:ExcelWorkbook>","<ss:WindowHeight>{windowHeight}</ss:WindowHeight>","<ss:WindowWidth>{windowWidth}</ss:WindowWidth>","<ss:ProtectStructure>{protectStructure}</ss:ProtectStructure>","<ss:ProtectWindows>{protectWindows}</ss:ProtectWindows>","</ss:ExcelWorkbook>","<ss:Styles>","{joinedCompiledStyles}","</ss:Styles>","{joinedWorksheets}","</ss:Workbook>"),addDefaultStyle:function(){var a=[{name:"Color",value:this.cellBorderColor},{name:"Weight",value:"1"},{name:"LineStyle",value:"Continuous"}];this.addStyle({id:"Default",attributes:[{name:"Alignment",properties:[{name:"Vertical",value:"Top"},{name:"WrapText",value:"1"}]},{name:"Font",properties:[{name:"FontName",value:"arial"},{name:"Size",value:"10"}]},{name:"Interior"},{name:"NumberFormat"},{name:"Protection"},{name:"Borders",children:[{name:"Border",properties:[{name:"Position",value:"Top"}].concat(a)},{name:"Border",properties:[{name:"Position",value:"Bottom"}].concat(a)},{name:"Border",properties:[{name:"Position",value:"Left"}].concat(a)},{name:"Border",properties:[{name:"Position",value:"Right"}].concat(a)}]}]})},addTitleStyle:function(){this.addStyle({id:"title",attributes:[{name:"Borders"},{name:"Font"},{name:"NumberFormat",properties:[{name:"Format",value:"@"}]},{name:"Alignment",properties:[{name:"WrapText",value:"1"},{name:"Horizontal",value:"Center"},{name:"Vertical",value:"Center"}]}]})},addHeaderStyle:function(){this.addStyle({id:"headercell",attributes:[{name:"Font",properties:[{name:"Bold",value:"1"},{name:"Size",value:"10"}]},{name:"Interior",properties:[{name:"Pattern",value:"Solid"},{name:"Color",value:"#A3C9F1"}]},{name:"Alignment",properties:[{name:"WrapText",value:"1"},{name:"Horizontal",value:"Center"}]}]})},addStripedStyles:function(){this.addStyle({id:"even",attributes:[{name:"Interior",properties:[{name:"Pattern",value:"Solid"},{name:"Color",value:"#CCFFFF"}]}]});this.addStyle({id:"odd",attributes:[{name:"Interior",properties:[{name:"Pattern",value:"Solid"},{name:"Color",value:"#CCCCFF"}]}]});Ext.each(["even","odd"],function(a){this.addChildNumberFormatStyle(a,a+"date","[ENG][$-409]dd-mmm-yyyy;@");this.addChildNumberFormatStyle(a,a+"int","0");this.addChildNumberFormatStyle(a,a+"float","0.00")},this)},addChildNumberFormatStyle:function(a,c,b){this.addStyle({id:c,parentStyle:"even",attributes:[{name:"NumberFormat",properties:[{name:"Format",value:b}]}]})}});Ext.define("LSP.view.usergrid.UserGrid",{extend:"Ext.form.Panel",alias:"widget.usergrid",initComponent:function(){this.items=[grid=Ext.widget("dynamicgrid")];grid.buttonRender(["new","edit","filter","delete","load","exporter"]);this.callParent(arguments)}});Ext.define("LSP.view.sparqlform.Queryform",{extend:"Ext.form.Panel",alias:"widget.queryform",closable:true,layout:{type:"vbox",align:"stretch"},initComponent:function(){this.items=[{xtype:"form",padding:"5 5 0 5",border:false,style:"background-color: #fff;",items:[{xtype:"textarea",name:"query",id:"query_id",fieldLabel:"SPARQL query",height:120,labelWidth:110,width:700,value:"SELECT *  WHERE { ?s ?p ?o}"},{xtype:"fieldcontainer",height:31,width:700,layout:{type:"column"},items:[{xtype:"numberfield",name:"limit",margin:"0 10 0 110",padding:"",width:190,fieldLabel:"Limit",labelWidth:110,autoStripChars:true,maxValue:100,minValue:1,value:10,allowDecimals:false},{xtype:"numberfield",name:"offset",margin:"0 10 0 0",width:190,fieldLabel:"Offset",labelWidth:110,maxValue:10000,minValue:0,value:0,allowDecimals:false}]},{xtype:"button",action:"query",text:"Submit query"}]},{xtype:"dynamicgrid3",title:"SPARQL query results",name:"sparql_query_results",flex:1}];this.callParent(arguments)}});Ext.define("LSP.view.cmpd_by_name.CmpdByNameForm",{extend:"Ext.form.Panel",alias:"widget.CmpdByNameForm",closable:true,requires:["LSP.view.dropdowns.conceptWikiCompoundLookup","LSP.view.dynamicgrid.DynamicGrid","LSP.view.cmpd_by_name.CmpdByNameSingleDisplayForm"],layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"label",html:'<span style="font-family: verdana; color: grey; ">Hint: Type in compound name. E.g. "Aspirin"</span>',labelWidth:400,padding:"5 0 0 140"},{xtype:"container",margin:"0 5 5 5",name:"form_fields",layout:{type:"column"},style:"background-color: #fff;",items:[Ext.create("CW.view.ConceptWikiLookup",{xtype:"conceptWikiLookup",fieldLabel:"Compound name",itemId:"compoundByNameLookup",name:"compound_uri",cwTagUuid:"07a84994-e464-4bbf-812a-a4b96fa3d197"}),{xtype:"button",padding:"5 5 5 5",text:"Search...",itemId:"CmpdByNameSubmit_id",disabled:true,action:"query_cmpd_by_name"}]},{xtype:"CmpdByNameSingleDisplayForm",flex:1}]});this.callParent(arguments)}});Ext.define("LSP.view.dropdowns.conceptWikiLookup",{extend:"Ext.form.ComboBox",alias:"widget.conceptWikiLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"concept_label"},{type:"string",name:"concept_url"},{type:"string",name:"concept_uuid"},{type:"string",name:"concept_alt_labels"},{type:"string",name:"tag_label"},{type:"string",name:"tag_uuid"}],proxy:{type:"ajax",api:{read:"/concept_wiki_api_calls/concept_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"concept_url",displayField:"concept_label",name:"concept_uri",minChars:4,hideTrigger:true,forceSelection:true,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:70,typeAheadDelay:150,queryDelay:700,fieldLabel:"Concept name",labelWidth:120,listConfig:{loadingText:"Searching...",emptyText:"No matching concepts found.",getInnerTpl:function(){return'<p><b>{concept_label}</b> <a href="{concept_url}" target="_blank">(definition)</a> <i>({tag_label})</i><br/ ><small><i>{concept_alt_labels}</i></small></p>'}}});Ext.define("LSP.view.concept.SummeryForm",{extend:"Ext.form.Panel",alias:"widget.SummeryForm",closable:true,requires:["LSP.view.dropdowns.conceptWikiLookup"],initComponent:function(){var a=this;a.items=[{xtype:"container",height:"6%",margin:"5 5 5 5",name:"form_fields",layout:{type:"column"},items:[{xtype:"conceptWikiLookup"},{xtype:"button",padding:"5 5 5 5",text:"Look up",action:"look_up_concept"},{name:"utf8",xtype:"hidden",value:"&#x2713;"},{name:"authenticity_token",xtype:"hidden",value:$$("meta[name=csrf-token]")[0].readAttribute("content")}]},object_grid=Ext.widget("dynamicgrid2"),subject_grid=Ext.widget("dynamicgrid2")];object_grid.setTitle("Concept Properties");object_grid.setHeight("47%");subject_grid.setTitle("Concept Relations");subject_grid.setHeight("47%");a.callParent(arguments)}});Ext.define("LSP.view.placeholder.temp",{extend:"Ext.form.Panel",alias:"widget.temp",closable:true,title:"OpenPhacts Exemplars",initComponent:function(){var a=this;Ext.applyIf(a,{xtype:"panel",bodyPadding:10,title:"OpenPhacts Exemplars",layout:"anchor",autoScroll:true,items:[{xtype:"label",text:"This page contains links to the OpenPhacts exemplars",labelWidth:600},{xtype:"displayfield",value:"<a target='_blank' href='http://ws.bioinfo.cnio.es/OpenPHACTS/'>Target Dossier</a>",labelWidth:600},{xtype:"displayfield",value:"<a target='_blank' href='http://cbn.zbh.uni-hamburg.de'>ChemBioNavigator</a> - username/password: cbn/cbn4ops",labelWidth:600},{xtype:"displayfield",value:"Polypharmacology Browser - no link yet",labelWidth:600}]});this.callParent(arguments)}});Ext.define("LSP.view.dropdowns.pmidLookup",{extend:"Ext.form.ComboBox",alias:"widget.pmidLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"pmid"},{type:"string",name:"pmid_uri"}],proxy:{type:"ajax",api:{read:"core_api_calls/pmid_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"pmid_uri",displayField:"pmid",name:"pmid_uri",minChars:2,hideTrigger:true,forceSelection:true,typeAhead:true,emptyText:"Start typing Pubmed id...",margin:"5 5 5 5",width:600,queryDelay:700,fieldLabel:"Pubmed id",labelWidth:120,listConfig:{loadingText:"Searching...",emptyText:"No matching pubmed ids found."}});Ext.define("LSP.view.textmining.pmidTextMiningHitsForm",{extend:"Ext.form.Panel",alias:"widget.pmidTextMiningHits",requires:["LSP.view.dropdowns.pmidLookup"],closable:true,height:560,width:606,bodyPadding:10,layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",activeItem:0,layout:{type:"column"},items:[{xtype:"pmidLookup",margin:"0 10 0 10",labelWidth:75,width:650},{xtype:"button",text:"Search...",action:"query",disabled:true,width:120}]},{xtype:"fieldset",height:200,layout:"anchor",defaults:{labelWidth:75},title:"Bibliographic information",items:[{xtype:"displayfield",fieldLabel:"Title",name:"title",anchor:"100%"},{xtype:"textarea",height:150,readOnly:true,fieldLabel:"Abstract",name:"abstract",anchor:"100%"}]},{xtype:"dynamicgrid2",title:"Text mined concepts",gridBaseTitle:"Text mined concepts",name:"textmining_hits",flex:1}]});a.callParent(arguments)}});Ext.define("LSP.view.dropdowns.wikiPathwaysCompoundLookup",{extend:"Ext.form.ComboBox",alias:"widget.wikiPathwaysCompoundLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"compound_name"},{type:"string",name:"compound_uri"}],proxy:{type:"ajax",api:{read:"/core_api_calls/wiki_pathway_compound_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"compound_uri",displayField:"compound_name",name:"compound_uri",minChars:4,hideTrigger:true,forceSelection:true,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:700,queryDelay:700,fieldLabel:"Compound name",labelWidth:120,listConfig:{loadingText:"Searching..."}});Ext.define("LSP.view.pathways.pathwayByCompoundForm",{extend:"Ext.form.Panel",alias:"widget.pathwayByCompoundForm",requires:["LSP.view.dropdowns.wikiPathwaysCompoundLookup"],closable:true,height:560,width:606,bodyPadding:10,layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",activeItem:0,layout:{type:"column"},items:[{xtype:"wikiPathwaysCompoundLookup",margin:"0 10 0 10",labelWidth:100,width:650},{xtype:"button",text:"Search...",disabled:true,action:"query",width:120}]},{xtype:"dynamicgrid2",title:"Pathways including compound",gridBaseTitle:"Pathways including compound",name:"pathway_by_cmpd_grid",flex:1,dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",text:"View pathway in WikiPathways applet (Google Chrome only)",action:"wp_view"}]}]}]});a.callParent(arguments)}});Ext.define("LSP.view.dropdowns.wikiPathwaysProteinLookup",{extend:"Ext.form.ComboBox",alias:"widget.wikiPathwaysProteinLookup",store:Ext.create("Ext.data.Store",{fields:[{type:"string",name:"wp_protein_name"},{type:"string",name:"wp_protein_uri"}],proxy:{type:"ajax",api:{read:"/core_api_calls/wiki_pathway_protein_lookup.json"},reader:{type:"json"}}}),queryMode:"remote",valueField:"wp_protein_uri",displayField:"wp_protein_name",name:"wp_protein_uri",minChars:4,hideTrigger:true,forceSelection:true,typeAhead:true,emptyText:"Start typing...",margin:"5 5 5 5",width:700,queryDelay:700,fieldLabel:"Protein name",labelWidth:120,listConfig:{loadingText:"Searching..."}});Ext.define("LSP.view.pathways.pathwayByProteinForm",{extend:"Ext.form.Panel",alias:"widget.pathwayByProteinForm",requires:["LSP.view.dropdowns.wikiPathwaysProteinLookup"],closable:true,height:560,width:606,bodyPadding:10,layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",activeItem:0,layout:{type:"column"},items:[{xtype:"wikiPathwaysProteinLookup",margin:"0 10 0 10",labelWidth:100,width:650},{xtype:"button",text:"Search...",action:"query",disabled:true,width:120}]},{xtype:"dynamicgrid2",title:"Pathways including protein",gridBaseTitle:"Pathways including protein",name:"pathway_by_protein_grid",flex:1,dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",text:"View pathway in WikiPathways applet (Google Chrome only)",action:"wp_view"}]}]}]});a.callParent(arguments)}});Ext.define("LSP.view.Viewer",{extend:"Ext.tab.Panel",alias:"widget.viewer",requires:["LSP.view.dynamicgrid.DynamicGrid","LSP.view.usergrid.UserGrid","LSP.view.sparqlform.Queryform","LSP.view.larkc_sim_search.SimSearchForm","LSP.view.cmpd_by_name.CmpdByNameForm","LSP.view.target_by_name.TargetByNameForm","LSP.view.pharm_by_cmpd_name2.PharmByCmpdNameForm","LSP.view.pharm_by_target_name2.PharmByTargetNameForm","LSP.view.concept.SummeryForm","LSP.view.placeholder.temp","LSP.view.pharm_by_enzyme_family.PharmEnzymeForm","LSP.view.textmining.pmidTextMiningHitsForm","LSP.view.pathways.pathwayByCompoundForm","LSP.view.pathways.pathwayByProteinForm",],activeItem:0,margins:"0 4 4 4",initComponent:function(){console.log("Viewer: initComponent()");this.callParent(arguments);this.on("tabchange",function(c,a,b){Ext.History.add("!p="+a.xtype)})}});Ext.define("LSP.view.feedback.FeedbackPanel",{extend:"Ext.panel.Panel",alias:"widget.FeedbackPanel",layout:"anchor",bodyCls:"fb-panel",border:false,items:[{xtype:"displayfield",value:"<br>",itemId:"spacer1"},{xtype:"displayfield",anchor:"100%",itemId:"fpUserMessage1",fieldCls:"fb-message",value:"You can use this form to give us feedback or report any problems you encounter.  Please note that we read everything, but can't always respond."},{xtype:"displayfield",value:"<br>",itemId:"spacer2"},{xtype:"textfield",anchor:"100%",vtype:"email",cls:"fb-email",labelAlign:"top",itemId:"fpUserEmail",fieldLabel:"Your contact email",allowBlank:false},{xtype:"textarea",anchor:"100% 60%",labelAlign:"top",itemId:"fpFeedbackText",fieldLabel:"Your feedback",allowBlank:false},{xtype:"button",cls:"fb-button",text:"Submit",handler:function(){var a=Ext.ComponentQuery.query("#fpUserEmail")[0];if(!a.isValid()){Ext.Msg.show({title:"Missing Information",msg:"Please supply a contact email address",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO});return}var d=Ext.ComponentQuery.query("#fpFeedbackText")[0];if(!d.isValid()){Ext.Msg.show({title:"Missing Information",msg:"Please supply some feedback text",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO});return}var c=Ext.create("LSP.model.Feedback",{userEmail:a.getValue(),feedbackText:d.getValue(),technicalInfo:Ext.History.getToken()});var b=this.up("FeedbackPanel");b.setLoading(true);Ext.Ajax.request({url:"feedback.json",method:"POST",params:c.data,success:function(e){b.setLoading(false);var f=Ext.decode(e.responseText);Ext.Msg.show({title:"Feedback sent",msg:f.message,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})},failure:function(e){b.setLoading(false);Ext.Msg.show({title:"Error",msg:"Your feedback could not be sent",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}})}}]});Ext.define("LSP.view.Navigator",{extend:"Ext.Panel",alias:"widget.navigator",requires:["LSP.view.Appmoduletree","Ext.layout.container.Accordion","LSP.view.feedback.FeedbackPanel"],collapsible:true,margins:"0 0 4 4",layout:"accordion",layoutConfig:{animate:true},initComponent:function(){this.items=[{title:"Navigation",autoScroll:true,layout:"fit",border:false,iconCls:"nav",items:[{xtype:"appmoduletree",id:"appModuleTree"}]},{title:"Feedback",border:false,autoScroll:true,iconCls:"fb-accordion",bodyBorder:false,items:[{xtype:"FeedbackPanel"}]}];this.callParent(arguments)}});Ext.define("LSP.view.user.Loginbutton",{extend:"Ext.Button",alias:"widget.loginbutton",size:"small",text:"Log in",initComponent:function(){this.callParent(arguments)}});Ext.define("LSP.view.user.Logoutbutton",{extend:"Ext.Button",alias:"widget.logoutbutton",size:"small",text:"Log out",initComponent:function(){this.callParent(arguments)}});Ext.define("LSP.view.user.Newbutton",{extend:"Ext.Button",alias:"widget.usernewbutton",size:"small",text:"Create account",initComponent:function(){this.callParent(arguments)}});iconSize="small";Ext.define("LSP.view.Viewport",{extend:"Ext.container.Viewport",alias:"widget.lspviewport",requires:["LSP.view.Viewer","LSP.view.Navigator","LSP.view.Settings","LSP.view.user.Loginbutton","LSP.view.user.Logoutbutton","LSP.view.user.Newbutton","Ext.layout.container.Border","Ext.toolbar.Spacer","LSP.store.GuiComponents"],listeners:{afterrender:{fn:function(){console.log("Viewport: afterrender()");var a=Ext.History.getToken();if(a){if(a.length>0){this.handleHistoryToken(a)}}}}},layout:"border",getFormByXtype:function(a){return Ext.data.StoreManager.lookup("GuiComponents").findRecord("xtype",a)},handleHistoryToken:function(b){console.log("Viewport: handleHistoryToken()");if(b){if(b.indexOf("!")==0){var a=this.parseHistoryToken(b.substring(1));if(a.p){var c=this.getFormByXtype(a.p);if(c){this.changeView(c,a)}}}}},parseHistoryToken:function(c){console.log("Viewport: parseHistoryToken()");var b={};var a=c.split("&");Ext.each(a,function(g){var f=g.indexOf("=");if(f!=-1){var d=g.substring(0,f);var e=g.substring(f+1,g.length);b[d]=e}});return b},changeView:function(b,c){console.log("Viewport: changeView()");var a;Ext.getCmp("centerView").items.each(function(e){if(e.gridId==b.data.id){a=e;return}});if(!a){a=Ext.widget(b.data.xtype);a.setTitle(b.data.home);a.url=b.data.url;a.gridId=b.data.id;Ext.getCmp("centerView").add(a)}var d=Ext.getCmp("centerView");d.suspendEvents(false);d.setActiveTab(a);d.resumeEvents();if(c){if(a.setFormData){a.setFormData(c)}else{a.fireEvent("historyToken",c)}}},initComponent:function(){console.log("Viewport: initComponent()");LDAProvenanceMode=LDA.helper.LDAConstants.LDA_PROVENANCE_COLOUR;Ext.History.init();Ext.History.on("change",function(b){if(b){this.handleHistoryToken(b)}},this);var a=Ext.create("Ext.Img",{src:"./assets/ops_logo.png",bodyStyle:{background:"transparent"}});this.items=[{region:"north",id:"northView",height:60,border:false,bodyStyle:{background:"transparent"},layout:{type:"hbox",padding:"5",align:"middle"},items:[a,{id:"lsp-header",xtype:"box",html:"<h1>Open PHACTS GUI</h1>"},{xtype:"tbspacer",flex:1},{xtype:"displayfield",value:"Testing connection to OPS API...",width:400,name:"ops_api_staus",id:"ops_api_staus_id",hidden:true},{xtype:"tbspacer",flex:1},{xtype:"loginbutton",id:"loginButton",hidden:true},{xtype:"usernewbutton",id:"userNewButton",hidden:true},{xtype:"logoutbutton",id:"logoutButton",hidden:true}]},{region:"center",id:"centerView",xtype:"viewer"},{region:"west",id:"westView",width:225,xtype:"navigator"}];this.callParent(arguments)}});Ext.create("Ext.app.Application",{name:"LSP",appFolder:"app",controllers:["LDAParserController","grids.DynamicGrid","NavigationTree","SimSearchForm","CmpdByNameForm","TargetByNameForm","PharmByTargetNameForm","PharmByCmpdNameForm","PharmByEnzymeFamily","Settings","CW.controller.ConceptWikiLookup"],launch:function(){console.log("Application: launch()");Ext.create("LSP.view.Viewport")}});